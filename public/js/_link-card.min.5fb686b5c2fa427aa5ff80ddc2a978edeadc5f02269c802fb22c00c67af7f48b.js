(function(){"use strict";function e(e,t){if(e==null)return t;if(Array.isArray(e))return e;if(typeof e=="string")try{const t=JSON.parse(e);if(Array.isArray(t))return t}catch{}return t}function s(){if(window.siteConfig&&window.siteConfig.linkCard){const t=window.siteConfig.linkCard,n=t.redirect||{},s={enable:t.enable,cardMode:t.cardMode||"external",openInNewTab:t.openInNewTab!==!1,showArticleInfo:t.showArticleInfo!==!1,showArticleTitle:t.showArticleTitle!==!1,showArticleDate:t.showArticleDate!==!1,showArticleSummary:t.showArticleSummary!==!1,redirectPage:t.redirectPage!==!1,replaceWhitelist:e(t.replaceWhitelist,[]),pageWhitelist:e(t.pageWhitelist,[]),elementWhitelist:e(t.elementWhitelist,[]),redirectWhitelist:e(t.redirectWhitelist,[]),redirect:{pagePath:n.pagePath||"/go.html",countdown:n.countdown!==0[0]?n.countdown:3,showCountdown:n.showCountdown!==!1,showButton:n.showButton!==!1,safeMessage:n.safeMessage||"ðŸ˜ƒ æ¥è‡ªæœ¬ç«™ï¼Œæœ¬ç«™å¯ç¡®ä¿å…¶å®‰å…¨æ€§ï¼Œè¯·æ”¾å¿ƒç‚¹å‡»è·³è½¬"}};return s}const t={enable:!1,cardMode:"external",openInNewTab:!0,showArticleInfo:!0,showArticleTitle:!0,showArticleDate:!0,showArticleSummary:!0,redirectPage:!0,replaceWhitelist:[],pageWhitelist:[],elementWhitelist:[],redirectWhitelist:[]};return t}function t(e){if(!e)return!1;try{const t=new URL(e,window.location.origin),n=t.origin===window.location.origin;return n}catch{const t=e.startsWith("/")||e.startsWith("#");return t}}function o(e,t){if(!t||t.length===0)return!1;const n=t.some(t=>{if(!t||t.trim()==="")return!1;try{const n=new RegExp(t);return n.test(e)}catch{return e.includes(t)}});return n}let n=null;async function a(e){if(!t(e))return null;try{const o=new URL(e,window.location.origin),s=o.pathname;if(!n)try{const e=await fetch("/index.json",{cache:"no-store"});if(!e.ok)return null;n=await e.json()}catch{return null}const t=n.find(e=>{const t=e.url||"";return t===s||t===o.pathname||t.replace(/\/$/,"")===s.replace(/\/$/,"")||s.endsWith(t)||t.endsWith(s)});return t?{title:t.title||"",date:t.date||"",description:t.description||"",url:t.url||""}:null}catch{return null}}async function r(e,n){const l=e.originalHref||e.href,i=t(l),h=i?"internal":"external";if(n.cardMode==="none")return null;if(n.cardMode==="internal"&&!i)return null;if(n.cardMode==="external"&&i)return null;const d=document.createElement("div");d.className="link-card-container";const s=document.createElement("a");s.className=`link-card-${h}`,s.href=e.href,n.openInNewTab&&(s.target="_blank",s.rel="noopener noreferrer");const c=document.createElement("div");c.className="link-card-header";const u=document.createElement("i");u.className=i?"fas fa-link":"fas fa-external-link-alt",u.classList.add("link-card-icon");const r=document.createElement("div");r.className="link-card-title";let o=null;if(i&&n.showArticleInfo?(o=await a(l),o&&n.showArticleTitle&&o.title?r.textContent=o.title:r.textContent=e.text||e.href):r.textContent=e.text||e.href,c.appendChild(u),c.appendChild(r),s.appendChild(c),i&&n.showArticleInfo){if(n.showArticleDate&&o&&o.date){const e=document.createElement("div");e.className="link-card-date";const t=document.createElement("i");t.className="fas fa-calendar-alt",e.appendChild(t),e.appendChild(document.createTextNode(o.date)),s.appendChild(e)}if(n.showArticleSummary&&o&&o.description){const e=document.createElement("div");e.className="link-card-summary",e.textContent=o.description,s.appendChild(e)}const e=document.createElement("div");e.className="link-card-url";const t=document.createElement("i");t.className="fas fa-globe",e.appendChild(t),e.appendChild(document.createTextNode(l)),s.appendChild(e)}else if(!i){const t=document.createElement("div");t.className="link-card-url";const n=document.createElement("i");n.className="fas fa-globe",t.appendChild(n);const o=e.originalHref||e.href;t.appendChild(document.createTextNode(o)),s.appendChild(t)}return d.appendChild(s),d}async function i(e){let n=[];if(e.elementWhitelist&&e.elementWhitelist.length>0)e.elementWhitelist.forEach(e=>{if(!e||e.trim()==="")return;const t=document.querySelectorAll(e);t.forEach(e=>{e&&!n.includes(e)&&n.push(e)})});else{const e=document.querySelector(".post-content");e&&n.push(e)}if(n.length===0){const e=[".post-content","article .content",".content","main article"];for(const s of e){const t=document.querySelector(s);if(t&&!n.includes(t)){n.push(t);break}}}if(n.length===0)return;for(let s=0;s<n.length;s++){const a=n[s],i=a.querySelectorAll("a[href]");for(let a=0;a<i.length;a++){const n=i[a],s=n.getAttribute("href");if(!s||s.trim()==="")continue;if(n.hasAttribute("data-fancybox"))continue;if(n.hasAttribute("data-no-replace"))continue;if(n.classList.contains("no-replace"))continue;if(n.closest(".link-card-container"))continue;if(s.includes("/go.html?goUrl=")||s.includes("/go/?goUrl="))continue;if(e.replaceWhitelist&&e.replaceWhitelist.length>0&&o(s,e.replaceWhitelist))continue;const u=t(s),c=s;let d=s,l=!1;if(!u&&e.redirectPage&&e.redirect){if(e.redirectWhitelist&&e.redirectWhitelist.length>0&&o(s,e.redirectWhitelist)){const t=e.redirect?.pagePath||"/go.html",o=`${t}?goUrl=${encodeURIComponent(s)}&type=goDown`;n.href=o,d=n.href,l=!0;continue}const t=e.redirect?.pagePath||"/go.html",i=`${t}?goUrl=${encodeURIComponent(s)}&type=goDown`;n.href=i,d=n.href,l=!0}if(e.enable&&e.cardMode!=="none"){const o=c,s=t(o),i=e.cardMode==="all"||e.cardMode==="internal"&&s||e.cardMode==="external"&&!s;if(i){const s=l?n.href:c,t=await r({href:s,originalHref:c,text:n.textContent.trim()},e);t&&(n.style.display="none",n.parentNode.insertBefore(t,n.nextSibling))}}}}}function c(){const e=s();if(!e.enable&&!e.redirectPage)return;if(e.pageWhitelist&&e.pageWhitelist.length>0){const t=window.location.pathname,n=e.pageWhitelist.some(e=>{if(!e||e.trim()==="")return!1;try{const n=new RegExp(e);return n.test(t)}catch{return t.includes(e)}});if(!n)return}async function t(){setTimeout(async()=>{await i(e)},200)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{t()}):t()}c(),document.addEventListener("pjax:complete",function(){setTimeout(()=>{const e=s();if(e.enable||e.redirectPage){if(e.pageWhitelist&&e.pageWhitelist.length>0){const t=window.location.pathname,n=e.pageWhitelist.some(e=>{if(!e||e.trim()==="")return!1;try{const n=new RegExp(e);return n.test(t)}catch{return t.includes(e)}});if(!n)return}(async()=>{await i(e)})()}},200)})})()