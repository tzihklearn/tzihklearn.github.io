(()=>{document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".mobile-menu-toggle"),t=document.querySelector(".site-nav-main"),n=document.querySelectorAll(".nav-item-dropdown > .nav-link-main, .nav-item-subdropdown > .nav-dropdown-link.has-children");e&&t&&(e.addEventListener("click",function(n){n.stopPropagation(),t.classList.toggle("mobile-open"),e.classList.toggle("active")}),document.addEventListener("click",function(n){n.target.closest(".site-header")||(t.classList.remove("mobile-open"),e.classList.remove("active"))}),t.addEventListener("click",function(n){window.innerWidth<=768&&n.target.tagName==="A"&&(t.classList.remove("mobile-open"),e.classList.remove("active"))})),n.forEach(function(e){e.addEventListener("click",function(e){if(window.innerWidth>768){e.preventDefault();const t=this.parentElement,n=document.querySelectorAll(".nav-item-dropdown.open, .nav-item-subdropdown.open");n.forEach(function(e){e!==t&&e.classList.remove("open")}),t.classList.toggle("open")}})}),document.addEventListener("click",function(e){e.target.closest(".site-nav-main")||document.querySelectorAll(".nav-item-dropdown.open, .nav-item-subdropdown.open").forEach(function(e){e.classList.remove("open")})})}),document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("back-to-top"),e=document.getElementById("sidebar-toggle"),t=document.getElementById("theme-toggle"),u=document.getElementById("reading-progress"),r=document.getElementById("immersive-mode"),O=document.getElementById("danmaku-mode"),n=document.body,s=document.documentElement,c=document.getElementById("fab-settings"),i=document.querySelector(".floating-buttons");function w(){const n=[d,c,e,t,u,r,O];n.forEach(function(e){e&&(e.style.display="flex")}),i&&i.classList.remove("fab-open")}function l(){const s=window.scrollY,e=s>300,t=n.classList.contains("scrolled");e&&!t?n.classList.add("scrolled"):!e&&t&&n.classList.remove("scrolled"),p()}function p(){if(!u)return;const s=window.innerHeight,o=document.documentElement.scrollHeight,i=window.scrollY||document.documentElement.scrollTop,t=o-s;let e=0;t>0?(e=Math.round(i/t*100),e=Math.max(1,Math.min(100,e))):e=100;const n=u.querySelector(".progress-number");n&&(n.textContent=e)}function y(){if(!d)return;l(),window.addEventListener("scroll",l),d.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function j(){if(!c||!i)return;c.addEventListener("click",function(){i.classList.toggle("fab-open")})}function g(){if(!e)return;const t=localStorage.getItem("sidebar-hidden");t==="true"&&(n.classList.add("sidebar-hidden"),h(!0)),e.addEventListener("click",()=>{const e=n.classList.toggle("sidebar-hidden");localStorage.setItem("sidebar-hidden",e),h(e)})}function h(t){const n=e.querySelector("i");n&&(t?(n.className="fas fa-columns",e.title="æ˜¾ç¤ºä¾§æ "):(n.className="fas fa-times",e.title="éšè—ä¾§æ "));const s=e.querySelector("svg");s&&(t?(s.innerHTML='<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line><line x1="15" y1="3" x2="15" y2="21"></line>',e.title="æ˜¾ç¤ºä¾§æ "):(s.innerHTML='<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line>',e.title="éšè—ä¾§æ "))}function v(){if(!t)return;b(),t.addEventListener("click",()=>{_()})}function b(){const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;let n=e||(t?"dark":"light");m(n)}function o(e){const t=e==="dark"?"#fff":"#000",o=e==="dark"?"#fff":"#000",n=document.querySelector(".message-comment-section");if(n){const e=n.querySelectorAll("p, span, div, li, td, th");e.forEach(e=>{!e.closest("a")&&!e.closest("button")&&!e.closest("input")&&!e.closest("textarea")&&!e.closest(".atk-submit")&&(e.style.color=t)}),n.style.color=t;const s=n.querySelectorAll("input, textarea, .atk-input, .atk-textarea");s.forEach(e=>{e.style.color=o})}const s=document.querySelector("article.post #artalk-comment");if(s){const e=s.querySelectorAll("p, span, div, li, td, th");e.forEach(e=>{!e.closest("a")&&!e.closest("button")&&!e.closest("input")&&!e.closest("textarea")&&!e.closest(".atk-submit")&&(e.style.color=t)}),s.style.color=t;const n=s.querySelectorAll("input, textarea, .atk-input, .atk-textarea");n.forEach(e=>{e.style.color=o})}const i=document.querySelectorAll("#artalk-comment");i.forEach(e=>{if(e.closest("article.post"))return;const n=e.querySelectorAll("p, span, div, li, td, th");n.forEach(e=>{!e.closest("a")&&!e.closest("button")&&!e.closest("input")&&!e.closest("textarea")&&!e.closest(".atk-submit")&&(e.style.color=t)}),e.style.color=t;const s=e.querySelectorAll("input, textarea, .atk-input, .atk-textarea");s.forEach(e=>{e.style.color=o})})}function f(e){o(e),setTimeout(()=>o(e),100),setTimeout(()=>o(e),500),setTimeout(()=>o(e),1e3)}function _(){const t=s.getAttribute("data-theme")||s.getAttribute("theme")||(document.body.classList.contains("dark")?"dark":"light"),e=t==="dark"?"light":"dark";m(e),localStorage.setItem("theme",e)}function m(e){s.setAttribute("data-theme",e),s.setAttribute("theme",e),e==="dark"?(document.body.classList.add("dark"),document.body.classList.remove("light")):(document.body.classList.add("light"),document.body.classList.remove("dark")),x(e),f(e)}document.addEventListener("pjax:complete",function(){const e=s.getAttribute("data-theme")||"light";f(e)});function a(){const e=document.querySelector(".message-comment-section"),t=document.querySelector("article.post #artalk-comment"),n=new MutationObserver(function(){const t=s.getAttribute("data-theme")||"light";o(t)});e&&n.observe(e,{childList:!0,subtree:!0}),t&&n.observe(t,{childList:!0,subtree:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a(),document.addEventListener("pjax:complete",function(){setTimeout(a,100)});function x(e){const n=t.querySelector("i");n&&(e==="dark"?(n.className="fas fa-sun",t.title="åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼"):(n.className="fas fa-moon",t.title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼"));const s=t.querySelector("svg");s&&(e==="dark"?(s.innerHTML='<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>',t.title="åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼"):(s.innerHTML='<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>',t.title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼"))}function C(){if(!r)return;const e=localStorage.getItem("immersive-mode");e==="true"&&n.classList.add("immersive-mode"),r.addEventListener("click",()=>{const e=n.classList.toggle("immersive-mode");localStorage.setItem("immersive-mode",e)})}function E(){w(),y(),g(),v(),C(),j(),setTimeout(()=>{l()},100)}E()}),window.addEventListener("load",function(){const e=document.body,t=window.scrollY;t>300&&e.classList.add("scrolled")}),function(){"use strict";class t{constructor(e){this.container=e,this.danmakuItems=[],this.comments=[],this.isActive=!1,this.updateTimer=null,this.config=window.siteConfig?.danmaku||{},this.artalkConfig=window.siteConfig||{},this.speed=this.config.speed||3,this.fontSize=this.config.fontSize||16,this.opacity=this.config.opacity||.9,this.maxCount=this.config.maxCount||50,this.updateInterval=this.config.updateInterval||3e4,this.showAvatar=this.config.showAvatar!==!1,this.showTime=this.config.showTime!==!1,this.loop=this.config.loop!==!1,this.randomPosition=this.config.randomPosition!==!1,this.colorful=this.config.colorful!==!1,this.antiOverlap=this.config.antiOverlap!==!1,this.colors=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2","#F8B500","#FF69B4","#00CED1","#FFD700","#E74C3C","#3498DB","#2ECC71","#F39C12","#9B59B6","#1ABC9C","#E67E22","#16A085"],this.tracks=[],this.trackHeight=60,this.initTracks(),this.allComments=[],this.displayedComments=new Set,this.activeDanmakus=[]}initTracks(){const e=Math.floor((window.innerHeight-100)/this.trackHeight);this.tracks=Array(e).fill(null).map(()=>({occupied:!1,lastDanmakuTime:0}))}checkOverlap(e,t=60){if(!this.antiOverlap)return!1;const n=Date.now(),s=12,o=t+s;for(let t of this.activeDanmakus){const s=Math.abs(t.y-e);if(s<o){const s=(n-t.startTime)/1e3,e=window.innerWidth-t.speed*50*s,o=window.innerWidth,i=o-e;if(e>-t.width){const e=Math.max(t.width,200);if(i<e)return!0}}}return!1}getYPosition(){if(this.randomPosition){const e=50,t=window.innerHeight-100;if(this.antiOverlap){let s=0;const i=50;for(;s<i;){const n=e+Math.random()*(t-e);if(!this.checkOverlap(n))return n;s++}for(let e=0;e<this.tracks.length;e++)if(!this.tracks[e].occupied)return{trackIndex:e,y:50+e*this.trackHeight,fallback:!0};const a=Date.now();let n=0,o=this.tracks[0].lastDanmakuTime;for(let e=1;e<this.tracks.length;e++)this.tracks[e].lastDanmakuTime<o&&(o=this.tracks[e].lastDanmakuTime,n=e);return{trackIndex:n,y:50+n*this.trackHeight,fallback:!0}}return e+Math.random()*(t-e)}const t=Date.now();for(let e=0;e<this.tracks.length;e++)if(!this.tracks[e].occupied&&t-this.tracks[e].lastDanmakuTime>2e3)return{trackIndex:e,y:50+e*this.trackHeight};const e=Math.floor(Math.random()*this.tracks.length);return{trackIndex:e,y:50+e*this.trackHeight}}async fetchComments(){try{const t=this.artalkConfig.artalkServer,n=this.artalkConfig.artalkSite;if(!t||!n)return[];const s=this.config.scope||"all",e=window.siteConfig?.currentPage||{};let o;if(s==="all")o=`${t}/api/v2/stats/latest_comments?site_name=${encodeURIComponent(n)}&limit=${this.maxCount}`;else{const i=new URLSearchParams({site_name:n,limit:this.maxCount.toString(),offset:"0"});s==="page"&&e.url?i.append("page_key",e.url):s==="post"&&e.type==="posts"&&e.url&&i.append("page_key",e.url),o=`${t}/api/v2/comments?${i.toString()}`}const i=await fetch(o);if(!i.ok)throw new Error(`HTTP ${i.status}`);const a=await i.json();return a.data||[]}catch{return[]}}createDanmakuElement(e){const t=document.createElement("div");if(t.className="danmaku-item",t.style.opacity=this.opacity,this.colorful){const e=this.colors[Math.floor(Math.random()*this.colors.length)];t.style.setProperty("--danmaku-color",e),t.classList.add("danmaku-colorful")}const r=e=>e.avatar_url?.trim()?e.avatar_url:e.avatar?.trim()?e.avatar:e.email_encrypted?.trim()?`https://weavatar.com/avatar/${e.email_encrypted}?d=mp&s=80`:"https://cravatar.cn/avatar/default?s=80";if(this.showAvatar){const n=document.createElement("img");n.className="danmaku-avatar",n.src=r(e),n.alt=e.nick||"åŒ¿åç”¨æˆ·",n.onerror=()=>{n.src="https://cravatar.cn/avatar/default?s=80"},t.appendChild(n)}const s=document.createElement("div");s.className="danmaku-content";const o=document.createElement("div");o.className="danmaku-author";const i=document.createElement("span");if(i.className="danmaku-author-name",i.textContent=e.nick||"åŒ¿åç”¨æˆ·",o.appendChild(i),this.showTime){const t=document.createElement("span");t.className="danmaku-time";const n=e.date||e.created_at;t.textContent=this.formatTime(n),o.appendChild(t)}s.appendChild(o);const a=document.createElement("div");a.className="danmaku-text";let n=this.stripHtml(e.content||"");if(!n||n.trim().length===0)return null;if(n.length>100&&(n=n.substring(0,100)+"..."),a.textContent=n,s.appendChild(a),t.appendChild(s),this.config.scope==="all"&&e.page_title){const n=document.createElement("span");n.className="danmaku-page",n.textContent=e.page_title,t.appendChild(n)}return t.style.cursor="pointer",t.addEventListener("click",()=>{this.jumpToComment(e)}),t.addEventListener("mouseenter",()=>{t.classList.add("paused")}),t.addEventListener("mouseleave",()=>{t.classList.remove("paused")}),t}addDanmaku(e){if(e.id&&this.displayedComments.has(e.id)){const t=this.danmakuItems.some(t=>t.comment&&t.comment.id===e.id);if(t)return}const t=this.createDanmakuElement(e);if(!t)return;const n=this.getYPosition();let o,s=null,a=!1;this.randomPosition?typeof n=="object"&&n.fallback?(o=n.y,s=n.trackIndex,a=!0):o=n:(o=n.y,s=n.trackIndex,this.tracks[s].occupied=!0),t.style.top=`${o}px`,t.style.left=`${window.innerWidth}px`,this.container.appendChild(t);const i=t.offsetWidth,l=(window.innerWidth+i)/(this.speed*50),r={y:o,speed:this.speed,startTime:Date.now(),width:i};this.activeDanmakus.push(r);const c=t.animate([{transform:"translateX(0)"},{transform:`translateX(-${window.innerWidth+i}px)`}],{duration:l*1e3,easing:"linear",fill:"forwards"});c.onfinish=()=>{t.remove(),(!this.randomPosition||a)&&s!==null&&(this.tracks[s].occupied=!1,this.tracks[s].lastDanmakuTime=Date.now());const n=this.activeDanmakus.indexOf(r);n>-1&&this.activeDanmakus.splice(n,1);const o=this.danmakuItems.findIndex(e=>e.element===t);o>-1&&this.danmakuItems.splice(o,1),this.loop&&e.id&&this.displayedComments.delete(e.id)},this.danmakuItems.push({element:t,animation:c,comment:e}),e.id&&this.displayedComments.add(e.id)}async start(){if(this.isActive)return;this.updateTimer&&(clearInterval(this.updateTimer),this.updateTimer=null),this.loopTimer&&(clearInterval(this.loopTimer),this.loopTimer=null),this.danmakuItems.forEach(e=>{e.animation&&e.animation.cancel(),e.element&&e.element.remove()}),this.danmakuItems=[],this.activeDanmakus=[],this.displayedComments.clear(),this.allComments=[],this.initTracks(),this.isActive=!0,this.container.style.display="block",setTimeout(()=>{this.container.classList.add("active")},10),await new Promise(e=>setTimeout(e,100)),await this.updateComments(),this.updateTimer=setInterval(()=>{this.isActive&&this.updateComments()},this.updateInterval),this.loop&&(this.loopTimer=setInterval(()=>{this.isActive&&this.danmakuItems.length<this.maxCount/2&&this.updateComments()},5e3))}stop(){if(!this.isActive)return;this.isActive=!1,this.container.classList.remove("active"),this.updateTimer&&(clearInterval(this.updateTimer),this.updateTimer=null),this.loopTimer&&(clearInterval(this.loopTimer),this.loopTimer=null),setTimeout(()=>{this.container.style.display="none",this.danmakuItems.forEach(e=>{e.animation&&e.animation.cancel(),e.element&&e.element.remove()}),this.danmakuItems=[],this.tracks.forEach(e=>{e.occupied=!1,e.lastDanmakuTime=0})},300)}async updateComments(){if(this._isUpdating)return;this._isUpdating=!0;try{const e=await this.fetchComments();if(e.length>0){const t=new Set(this.allComments.map(e=>e.id)),n=e.filter(e=>e.id&&!t.has(e.id));this.allComments=[...this.allComments,...n]}if(this.allComments.length===0)return;if(this.loop){{this.displayedComments.size>=this.allComments.length&&this.displayedComments.clear();const e=this.allComments.filter(e=>e.id&&!this.displayedComments.has(e.id)),n=this.danmakuItems.length,t=this.maxCount-n;if(t>0&&e.length>0){const n=e.slice(0,Math.min(t,e.length));n.forEach((e,t)=>{setTimeout(()=>{this.isActive&&this.danmakuItems.length<this.maxCount&&(this.displayedComments.has(e.id)||this.addDanmaku(e))},t*500)})}}}else{const e=this.allComments.filter(e=>e.id&&!this.displayedComments.has(e.id)),n=this.danmakuItems.length,t=this.maxCount-n;if(t>0&&e.length>0){const n=e.slice(0,Math.min(t,e.length));n.forEach((e,t)=>{setTimeout(()=>{this.isActive&&this.danmakuItems.length<this.maxCount&&(this.displayedComments.has(e.id)||this.addDanmaku(e))},t*500)})}}}finally{setTimeout(()=>{this._isUpdating=!1},1e3)}}jumpToComment(e){const t=e.page_url||e.page_key||"",n=e.id||"";if(!t)return;try{const o=location.origin,e=new URL(t,o);let s=e.href;e.origin===o&&(s=e.pathname+e.search+e.hash),n&&(s+=(s.includes("#")?"":"#")+`atk-comment-${n}`);const i=window.location.pathname;if(e.pathname===i){const e=document.getElementById(`atk-comment-${n}`);if(e)e.scrollIntoView({behavior:"smooth",block:"center"});else{const e=document.querySelector(".artalk");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}}else window.location.href=s}catch{window.location.href=t}}stripHtml(e){if(!e)return"";const t=document.createElement("div");t.innerHTML=e;const s=["img","picture","atok-emoticon","emoji","svg","iframe","video"];s.forEach(e=>{const n=t.querySelectorAll(e);n.forEach(e=>e.remove())});let n=t.textContent||t.innerText||"";return n=n.replace(/\s+/g," ").trim(),n}formatTime(e){const s=new Date,n=new Date(e),t=Math.floor((s-n)/1e3);return t<60?"åˆšåˆš":t<3600?`${Math.floor(t/60)}åˆ†é’Ÿå‰`:t<86400?`${Math.floor(t/3600)}å°æ—¶å‰`:t<2592e3?`${Math.floor(t/86400)}å¤©å‰`:n.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})}}function e(){const n=document.getElementById("danmaku-mode"),o=document.getElementById("danmaku-container");if(!n||!o)return;const c=window.siteConfig?.danmaku||{};if(c.enable===!1){n.style.display="none";return}n._danmakuInitialized&&(n._danmakuClickHandler&&n.removeEventListener("click",n._danmakuClickHandler),n._danmakuInstance&&n._danmakuInstance.isActive&&n._danmakuInstance.stop(),n._danmakuResizeHandler&&window.removeEventListener("resize",n._danmakuResizeHandler));let e=null,s=!1;const i=async()=>{s?(e&&e.stop(),s=!1,n.classList.remove("active")):(e&&e.isActive&&(e.stop(),await new Promise(e=>setTimeout(e,400))),e&&(e.updateTimer&&(clearInterval(e.updateTimer),e.updateTimer=null),e.loopTimer&&(clearInterval(e.loopTimer),e.loopTimer=null),e.danmakuItems&&e.danmakuItems.forEach(e=>{e.animation&&e.animation.cancel(),e.element&&e.element.remove()})),e=new t(o),n._danmakuInstance=e,await e.start(),s=!0,n.classList.add("active"))};n._danmakuClickHandler=i,n.addEventListener("click",i);let a;const r=()=>{e&&(clearTimeout(a),a=setTimeout(()=>{e.initTracks()},300))};n._danmakuResizeHandler=r,window.addEventListener("resize",r),n._danmakuInitialized=!0}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),window.initDanmaku=e}(),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll("article.post .post-content pre");e.forEach((e)=>{const f=t(e),p=e.textContent||"",u=document.createElement("div");u.className="code-container";const d=document.createElement("div");d.className="code-header";const m=document.createElement("span");m.className="code-language",m.innerHTML=`<i class="fas fa-code"></i>${f}`;const c=document.createElement("div");c.className="code-actions";const i=document.createElement("button");i.className="code-btn copy-btn",i.innerHTML='<i class="far fa-copy"></i>å¤åˆ¶',i.title="å¤åˆ¶ä»£ç ";const l=document.createElement("button");l.className="code-btn download-btn",l.innerHTML='<i class="fas fa-download"></i>ä¸‹è½½',l.title="ä¸‹è½½ä»£ç ";const a=document.createElement("button");a.className="code-btn fold-btn",a.innerHTML='<i class="fas fa-chevron-down"></i>æŠ˜å ',a.title="æŠ˜å ä»£ç ",c.appendChild(i),c.appendChild(l),c.appendChild(a),d.appendChild(m),d.appendChild(c);const r=document.createElement("div");r.className="code-content",r.appendChild(e.cloneNode(!0)),u.appendChild(d),u.appendChild(r),e.parentNode.replaceChild(u,e),i.addEventListener("click",function(){navigator.clipboard.writeText(p).then(()=>{const e=i.innerHTML;i.innerHTML='<i class="fas fa-check"></i>å·²å¤åˆ¶',i.style.background="var(--accent)",i.style.borderColor="var(--accent)",i.style.color="#fff",setTimeout(()=>{i.innerHTML=e,i.style.background="",i.style.borderColor="",i.style.color=""},2e3)}).catch(e=>{console.error("å¤åˆ¶å¤±è´¥:",e),i.innerHTML='<i class="fas fa-times"></i>å¤±è´¥',setTimeout(()=>{i.innerHTML='<i class="far fa-copy"></i>å¤åˆ¶'},2e3)})}),l.addEventListener("click",function(){const s=new Blob([p],{type:"text/plain"}),t=URL.createObjectURL(s),e=document.createElement("a");e.href=t,e.download=`${f}-${Date.now()}.${n(f)}`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(t)});let o=!1;const h=r.querySelector("pre"),g=p.split(`
`).length;if(g>20){o=!0,h.classList.add("collapsed"),a.innerHTML='<i class="fas fa-chevron-down"></i>å±•å¼€';const e=document.createElement("button");e.className="code-toggle collapsed",e.innerHTML='<i class="fas fa-chevron-down"></i>å±•å¼€ä»£ç ',r.appendChild(e),e.addEventListener("click",function(){o=!o,h.classList.toggle("collapsed",o),a.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€':'<i class="fas fa-chevron-up"></i>æŠ˜å ',e.classList.toggle("collapsed",o),e.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€ä»£ç ':'<i class="fas fa-chevron-up"></i>æ”¶èµ·ä»£ç '})}a.addEventListener("click",function(){o=!o,h.classList.toggle("collapsed",o),a.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€':'<i class="fas fa-chevron-up"></i>æŠ˜å ';let e=r.querySelector(".code-toggle");!e&&o&&(e=document.createElement("button"),e.className="code-toggle collapsed",r.appendChild(e),e.addEventListener("click",function(){o=!o,h.classList.toggle("collapsed",o),a.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€':'<i class="fas fa-chevron-up"></i>æŠ˜å ',e.classList.toggle("collapsed",o),e.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€ä»£ç ':'<i class="fas fa-chevron-up"></i>æ”¶èµ·ä»£ç '})),e&&(e.classList.toggle("collapsed",o),e.innerHTML=o?'<i class="fas fa-chevron-down"></i>å±•å¼€ä»£ç ':'<i class="fas fa-chevron-up"></i>æ”¶èµ·ä»£ç ',o||setTimeout(()=>{!o&&e&&e.remove()},300))})});function t(e){let t="code";const n=e.className.split(/\s+/);for(const s of n){const e=s.match(/^(language|lang)-(.+)$/);if(e){t=e[2];break}}if(t==="code"&&e.firstElementChild&&e.firstElementChild.tagName==="CODE"){const n=e.firstElementChild,s=n.className.split(/\s+/);for(const n of s){const e=n.match(/^(language|lang)-(.+)$/);if(e){t=e[2];break}}}const s={js:"JavaScript",javascript:"JavaScript",ts:"TypeScript",typescript:"TypeScript",py:"Python",python:"Python",html:"HTML",css:"CSS",scss:"SCSS",sass:"SASS",less:"LESS",json:"JSON",xml:"XML",md:"Markdown",markdown:"Markdown",yml:"YAML",yaml:"YAML",bash:"Bash",shell:"Shell",sh:"Shell",zsh:"Zsh",powershell:"PowerShell",ps1:"PowerShell",cpp:"C++","c++":"C++",c:"C",cs:"C#",csharp:"C#",java:"Java",php:"PHP",rb:"Ruby",ruby:"Ruby",go:"Go",golang:"Go",rs:"Rust",rust:"Rust",sql:"SQL",mysql:"MySQL",pgsql:"PostgreSQL",dockerfile:"Dockerfile",docker:"Dockerfile",makefile:"Makefile",make:"Makefile"};return s[t]||t.charAt(0).toUpperCase()+t.slice(1)}function n(e){const t={javascript:"js",typescript:"ts",python:"py",java:"java",cpp:"cpp",c:"c",csharp:"cs",html:"html",css:"css",scss:"scss",sass:"sass",less:"less",php:"php",ruby:"rb",go:"go",rust:"rs",shell:"sh",bash:"sh",json:"json",xml:"xml",yaml:"yml",markdown:"md"},n={JavaScript:"js",TypeScript:"ts",Python:"py",Java:"java","C++":"cpp",C:"c","C#":"cs",HTML:"html",CSS:"css",SCSS:"scss",SASS:"sass",LESS:"less",PHP:"php",Ruby:"rb",Go:"go",Rust:"rs",Shell:"sh",Bash:"sh",JSON:"json",XML:"xml",YAML:"yml",Markdown:"md"};return n[e]||t[e.toLowerCase()]||"txt"}});function I(){const e=document.querySelector(".aside-card .toc-content");if(!e)return;const t=Array.from(document.querySelectorAll("article h1[id], article h2[id], article h3[id], article h4[id]")),n=e.querySelectorAll(".toc-content a");if(t.length===0||n.length===0)return;const s=new IntersectionObserver(t=>{try{let n=null;if(t.forEach(t=>{if(!t.target||!t.isIntersecting)return;const o=t.target.getAttribute("id");if(!o)return;const i=e.querySelector(`.toc-content a[href="#${o}"]`);if(!i)return;const s=i.parentElement;if(!s)return;n?t.boundingClientRect&&t.boundingClientRect.top&&(n=s):n=s}),e.querySelectorAll(".toc-content li.active").forEach(e=>{e.classList.remove("active")}),n&&n.classList){n.classList.add("active");const t=e.querySelector(".toc-content");if(t&&t.scrollHeight>t.clientHeight){const e=n.offsetTop-t.offsetTop-30;e>=0&&t.scrollTo({top:e,behavior:"smooth"})}}}catch{}},{rootMargin:"0px 0px -50% 0px",threshold:.1});t.forEach(e=>{e.id&&s.observe(e)}),n.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.getAttribute("href")?.substring(1);if(!n)return;const s=document.getElementById(n);if(s){const e=s.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:e,behavior:"smooth"}),history.pushState(null,null,`#${n}`)}})})}document.addEventListener("DOMContentLoaded",I),window.initToc=I;var l,d,f,x,E,q,Y,s=[],n=0;function w(e){n=e;const o=s[n],t=document.querySelector(".img-fullscreen-overlay"),r=t.querySelector("img"),i=t.querySelector(".img-fullscreen-info"),a=t.querySelector(".img-fullscreen-counter");r.src=o.src,r.alt=o.alt,o.alt?(i.textContent=o.alt,i.style.display="block"):i.style.display="none",s.length>1?(a.textContent=`${n+1} / ${s.length}`,a.style.display="block",t.querySelector(".img-fullscreen-prev").style.display="flex",t.querySelector(".img-fullscreen-next").style.display="flex"):(a.style.display="none",t.querySelector(".img-fullscreen-prev").style.display="none",t.querySelector(".img-fullscreen-next").style.display="none"),t.classList.add("active"),document.body.style.overflow="hidden"}function C(){const e=document.querySelector(".img-fullscreen-overlay");e.classList.remove("active"),document.body.style.overflow=""}function k(){n=(n-1+s.length)%s.length,w(n)}function j(){n=(n+1)%s.length,w(n)}function b(){let e=document.querySelector(".img-fullscreen-overlay");e||(e=document.createElement("div"),e.className="img-fullscreen-overlay",e.innerHTML=`
            <div class="img-fullscreen-container">
                <button class="img-fullscreen-close">&times;</button>
                <div class="img-fullscreen-counter"></div>
                <button class="img-fullscreen-nav img-fullscreen-prev">&lsaquo;</button>
                <img src="" alt="">
                <button class="img-fullscreen-nav img-fullscreen-next">&rsaquo;</button>
                <div class="img-fullscreen-info"></div>
            </div>
        `,document.body.appendChild(e),e.addEventListener("click",function(t){t.target===e&&C()}),e.querySelector(".img-fullscreen-close").addEventListener("click",C),e.querySelector(".img-fullscreen-prev").addEventListener("click",k),e.querySelector(".img-fullscreen-next").addEventListener("click",j)),s=Array.from(document.querySelectorAll("article.post .post-content img"));let t=null;s.forEach((e,t)=>{const n=function(e){this._clickTimer?(clearTimeout(this._clickTimer),this._clickTimer=null,w(t),e.preventDefault()):this._clickTimer=setTimeout(()=>{this._clickTimer=null},300)};e._imageClickHandler&&e.removeEventListener("click",e._imageClickHandler),e._imageClickHandler=n,e.addEventListener("click",n),e._hoverHandlerBound||(e.addEventListener("mouseenter",function(){this.dataset.hintShown||(this.classList.add("double-click-hint"),setTimeout(()=>{this.classList.remove("double-click-hint")},300),this.dataset.hintShown="true")}),e._hoverHandlerBound=!0)})}if(window._imageViewerKeyboardBound||(document.addEventListener("keydown",function(e){const t=document.querySelector(".img-fullscreen-overlay");if(!t||!t.classList.contains("active"))return;switch(e.key){case"Escape":C();break;case"ArrowLeft":k();break;case"ArrowRight":j();break}}),window._imageViewerKeyboardBound=!0),!window._imageViewerTouchBound){let e=0;document.body.addEventListener("touchstart",function(t){const n=document.querySelector(".img-fullscreen-overlay");if(!n||!n.classList.contains("active"))return;e=t.changedTouches[0].screenX}),document.body.addEventListener("touchend",function(t){const n=document.querySelector(".img-fullscreen-overlay");if(!n||!n.classList.contains("active"))return;const o=t.changedTouches[0].screenX,s=o-e;(s<0?-s:s)>50&&(s>0?k():j())}),window._imageViewerTouchBound=!0}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",b):b(),window.initImageViewer=b,function(){const e=document.querySelector("[data-recent-comments]");if(!e)return;const t=e.dataset.enable==="true",n=Number(e.dataset.limit||5),s=e.dataset.server,o=e.dataset.siteName,i=e.dataset.gravatar||"mp";if(!t){e.closest(".recent-comments-card").style.display="none";return}const a=e=>e.avatar_url?.trim()?e.avatar_url:e.avatar?.trim()?e.avatar:e.email_encrypted?.trim()?`https://weavatar.com/avatar/${e.email_encrypted}?d=${i}&s=240`:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjZGRkIi8+PC9zdmc+",r=`${s}/api/v2/stats/latest_comments?site_name=${encodeURIComponent(o)}&limit=${n}`;fetch(r).then(e=>e.ok?e.json():Promise.reject(new Error("HTTP "+e.status))).then(t=>{const n=t.data||[];if(!n.length){e.innerHTML='<p class="no-data">æš‚æ— è¯„è®º</p>';return}const s=location.origin;e.innerHTML=n.map(e=>{let t=e.page_url||"";try{const e=new URL(t);e.origin===s&&(t=e.pathname+e.search+e.hash)}catch{}const o=a(e),n=e.nick||"åŒ¿åç”¨æˆ·",i=e.date?new Date(e.date).toLocaleDateString():"æœªçŸ¥æ—¶é—´",r=e.id||"";let c=(e.content||"").replace(/<img[^>]*>/g,"[è¡¨æƒ…]").replace(/<[^>]*>/g,"").slice(0,50);return`
            <a class="rc-item" href="${t}#atk-comment-${r}" title="æŸ¥çœ‹è¯„è®º">
              <img class="rc-avatar" src="${o}" alt="${n}" loading="lazy">
              <div class="rc-body">
                <div class="rc-header">
                  <span class="rc-nick">${n}</span>
                  <time>${i}</time>
                </div>
                <div class="rc-content">${c}</div>
              </div>
            </a>`}).join("")}).catch(t=>{console.error("[recent-comments]",t),t.message.includes("Failed to fetch")||t.message.includes("NetworkError")?e.innerHTML='<p class="no-data">è¯„è®ºæœåŠ¡å™¨æš‚æ—¶ä¸å¯ç”¨</p>':e.innerHTML=`<p class="no-data">åŠ è½½å¤±è´¥: ${t.message}</p>`})}(),function(){document.addEventListener("DOMContentLoaded",function(){const p=new URLSearchParams(location.search),n=(p.get("q")||"").trim(),t=document.getElementById("search-input"),s=document.getElementById("search-results"),o=document.getElementById("search-result-count"),u=document.querySelector(".nav-search-trigger"),e=document.getElementById("search-modal"),l=e?e.querySelector(".search-overlay"):null,c=e?e.querySelector(".search-close"):null;u&&e&&u.addEventListener("click",function(){e.classList.add("open"),setTimeout(function(){t&&t.focus()},50)}),l&&l.addEventListener("click",function(){e.classList.remove("open")}),c&&c.addEventListener("click",function(){e.classList.remove("open")}),t&&n&&(t.value=n);const f=window.__SEARCH_ENGINE__||"local";if(f!=="local")return;let i=null;function r(){return i?Promise.resolve(i):fetch("/index.json",{cache:"no-store"}).then(function(e){return e.json()}).then(function(e){return i=e,e})}function g(e){return String(e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(e,t){if(!t)return m(e||"");const n=new RegExp("("+g(t)+")","ig");return m(e||"").replace(n,"<mark>$1</mark>")}function a(t,n){if(!s||!o)return;if(!t){o.textContent="",s.innerHTML="";return}const i=t.toLowerCase(),a=n.filter(function(e){const t=(e.title||"").toLowerCase(),n=(e.description||"").toLowerCase(),s=(e.tags||[]).join(" ").toLowerCase(),o=(e.categories||[]).join(" ").toLowerCase();return t.includes(i)||n.includes(i)||s.includes(i)||o.includes(i)}).slice(0,50);if(o.textContent="æ‰¾åˆ° "+a.length+" æ¡ç»“æœ",s.innerHTML=a.map(function(e){return'<li class="search-item"><a class="search-title" href="'+e.url+'">'+d(e.title,t)+'</a><p class="search-desc">'+d((e.description||"").slice(0,160),t)+"</p></li>"}).join(""),window.innerWidth<=768&&e){const t=s.querySelectorAll(".search-title");t.forEach(function(t){t.addEventListener("click",function(){setTimeout(function(){e.classList.remove("open")},100)})})}}let h=null;t?(t.addEventListener("input",function(){const e=t.value.trim();clearTimeout(h),h=setTimeout(function(){if(!e){s&&(s.innerHTML=""),o&&(o.textContent="");return}r().then(function(t){a(e,t)})},150)}),n&&(t.value=n,r().then(function(e){a(n,e)}))):n&&r().then(function(e){a(n,e)});function m(e){return String(e).replace(/[&<>"]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[e]})}})}(),Y=class{constructor(){this.container=document.getElementById("masonry-container"),this.columns=this.container?.querySelectorAll(".masonry-column")||[],this.loadMoreBtn=document.getElementById("load-more-btn"),this.loadingSpinner=document.getElementById("loading-spinner"),this.currentPage=2,this.totalPages=parseInt(this.loadMoreBtn?.dataset.totalPages)||1,this.isLoading=!1,this.hasMorePages=!0,this.init()}init(){if(!this.loadMoreBtn||!this.hasMorePages){this.hideLoadMore();return}this.initializeExistingPosts(),this.loadMoreBtn.addEventListener("click",()=>this.loadMorePosts()),window.addEventListener("scroll",()=>this.handleScroll()),this.checkMorePages()}initializeExistingPosts(){const e=document.querySelectorAll(".masonry-item");e.forEach((e,t)=>{const n=e.closest(".masonry-column");n||this.addPostToMasonry(e,t)})}addPostToMasonry(e,t){if(this.columns.length===0)return;const n=t%3,s=this.columns[n],o=e.cloneNode(!0);s.appendChild(o)}async loadMorePosts(){if(this.isLoading||!this.hasMorePages)return;this.isLoading=!0,this.showLoading();try{const e=await fetch(`/?page=${this.currentPage}`);if(!e.ok)throw new Error("Network response was not ok");const n=await e.text(),s=new DOMParser,o=s.parseFromString(n,"text/html"),t=o.querySelector(".masonry-grid");if(t){const e=t.querySelectorAll(".masonry-item");if(e.length>0){const t=new Set;document.querySelectorAll(".masonry-item .post-title a").forEach(e=>{t.add(e.href)});const n=e.filter(e=>{const n=e.querySelector(".post-title a").href;return!t.has(n)});if(n.length>0){const e=document.querySelectorAll(".masonry-item"),t=e.length;n.forEach((e,n)=>{this.addPostToMasonry(e,t+n)}),this.currentPage++,this.hasMorePages=!0,this.checkMorePages(),window.dispatchEvent(new CustomEvent("masonryContentLoaded"))}else this.currentPage++,this.hasMorePages=!0,this.checkMorePages()}else this.currentPage++,this.hasMorePages=!0,this.checkMorePages()}}catch(e){console.error("åŠ è½½æ›´å¤šæ–‡ç« å¤±è´¥:",e),this.currentPage++,this.hasMorePages=!0}finally{this.isLoading=!1,this.hideLoading(),this.checkMorePages()}}handleScroll(){if(this.isLoading||!this.hasMorePages)return;const e=window.pageYOffset||document.documentElement.scrollTop,t=window.innerHeight,n=document.documentElement.scrollHeight;e+t>=n-300&&this.loadMorePosts()}showLoading(){this.loadMoreBtn&&(this.loadMoreBtn.style.display="none"),this.loadingSpinner&&(this.loadingSpinner.style.display="flex")}hideLoading(){this.loadMoreBtn&&(this.loadMoreBtn.style.display="block"),this.loadingSpinner&&(this.loadingSpinner.style.display="none")}hideLoadMore(){this.loadMoreBtn&&(this.loadMoreBtn.style.display="none"),this.loadingSpinner&&(this.loadingSpinner.style.display="none")}checkMorePages(){this.hasMorePages||this.hideLoadMore()}},document.addEventListener("DOMContentLoaded",function(){document.querySelector(".masonry-grid")&&new Y}),document.addEventListener("DOMContentLoaded",function(){const e=["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#54a0ff","#5f27cd","#00d2d3","#ff9f43","#10ac84","#ee5a24","#0984e3","#a29bfe","#fd79a8"],n=document.querySelectorAll(".link-tag");n.forEach(t=>{const n=e[Math.floor(Math.random()*e.length)];t.style.backgroundColor=n});const s=document.querySelectorAll(".link-card");s.forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="translateY(-3px) scale(1.02)",this.style.boxShadow="0 8px 25px rgba(0, 0, 0, 0.15)"}),e.addEventListener("mouseleave",function(){this.style.transform="translateY(0) scale(1)",this.style.boxShadow="0 2px 12px rgba(0, 0, 0, 0.06)"}),e.addEventListener("click",function(e){e.stopPropagation()})});const o=document.querySelectorAll(".link-avatar img");o.forEach(e=>{e.addEventListener("error",function(){this.src="/img/avatar.png",this.alt="é»˜è®¤å¤´åƒ"}),"loading"in HTMLImageElement.prototype&&(e.loading="lazy")});const t=document.querySelector(".comment-section");if(t){const e=document.createElement("button");e.textContent="å‰å¾€è¯„è®ºåŒº",e.className="scroll-to-comment-btn",e.style.cssText=`
      display: block;
      margin: 1.5rem auto;
      padding: 0.6rem 1.2rem;
      background: var(--accent-primary);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s ease;
    `,e.addEventListener("mouseenter",function(){this.style.background="var(--accent-secondary)",this.style.transform="translateY(-1px)"}),e.addEventListener("mouseleave",function(){this.style.background="var(--accent-primary)",this.style.transform="translateY(0)"}),e.addEventListener("click",function(){t.scrollIntoView({behavior:"smooth"})});const n=document.querySelector(".links-groups");n&&n.appendChild(e)}const i=document.querySelectorAll(".group-title");i.forEach(e=>{e.style.cursor="pointer",e.addEventListener("click",function(){const t=this.closest(".links-group"),e=t.querySelector(".links-grid");e.style.display=e.style.display==="none"?"grid":"none"})}),J()});function J(){if(!document.querySelector(".links-page"))return;const e=document.querySelectorAll(".link-card[data-link-url]");if(e.length===0)return;e.forEach((e,t)=>{setTimeout(()=>{const t=e.getAttribute("data-link-url");t&&ue(e,t)},t*150)})}async function ue(e,t){const n=e.querySelector(".link-status-badge");if(!n)return;const s=`link-status-${btoa(t).replace(/[+/=]/g,"")}`,o=localStorage.getItem(s);if(o){const e=JSON.parse(o);if(e.timestamp&&Date.now()-e.timestamp<24*60*60*1e3){r(n,e.status);return}}n.setAttribute("data-status","checking");try{const e=new AbortController,o=setTimeout(()=>e.abort(),8e3);try{const i=await fetch(t,{method:"HEAD",mode:"cors",signal:e.signal,cache:"no-cache"});if(clearTimeout(o),i.ok||i.status===200){const e="normal";r(n,e),localStorage.setItem(s,JSON.stringify({status:e,timestamp:Date.now()}));return}const a="error";r(n,a),localStorage.setItem(s,JSON.stringify({status:a,timestamp:Date.now()}));return}catch{clearTimeout(o);const e=new AbortController,i=setTimeout(()=>e.abort(),5e3);try{const a=await fetch(t,{method:"GET",mode:"no-cors",signal:e.signal,cache:"no-cache"});clearTimeout(i);const o="normal";r(n,o),localStorage.setItem(s,JSON.stringify({status:o,timestamp:Date.now()}))}catch{clearTimeout(i);const e="error";r(n,e),localStorage.setItem(s,JSON.stringify({status:e,timestamp:Date.now()}))}}}catch{const e="error";r(n,e),localStorage.setItem(s,JSON.stringify({status:e,timestamp:Date.now()}))}}function r(e,t){e.setAttribute("data-status",t);const n=e.querySelector(".status-text");n&&(t==="normal"?(n.textContent="",n.style.display="none"):t==="error"?n.textContent="å¼‚å¸¸":n.textContent="æ£€æµ‹ä¸­")}function y(){const e=document.querySelector("#talk");if(!e)return;e.innerHTML="";const n=()=>`<svg viewBox="0 0 512 512"xmlns="http://www.w3.org/2000/svg"class="is-badge icon"><path d="m512 268c0 17.9-4.3 34.5-12.9 49.7s-20.1 27.1-34.6 35.4c.4 2.7.6 6.9.6 12.6 0 27.1-9.1 50.1-27.1 69.1-18.1 19.1-39.9 28.6-65.4 28.6-11.4 0-22.3-2.1-32.6-6.3-8 16.4-19.5 29.6-34.6 39.7-15 10.2-31.5 15.2-49.4 15.2-18.3 0-34.9-4.9-49.7-14.9-14.9-9.9-26.3-23.2-34.3-40-10.3 4.2-21.1 6.3-32.6 6.3-25.5 0-47.4-9.5-65.7-28.6-18.3-19-27.4-42.1-27.4-69.1 0-3 .4-7.2 1.1-12.6-14.5-8.4-26-20.2-34.6-35.4-8.5-15.2-12.8-31.8-12.8-49.7 0-19 4.8-36.5 14.3-52.3s22.3-27.5 38.3-35.1c-4.2-11.4-6.3-22.9-6.3-34.3 0-27 9.1-50.1 27.4-69.1s40.2-28.6 65.7-28.6c11.4 0 22.3 2.1 32.6 6.3 8-16.4 19.5-29.6 34.6-39.7 15-10.1 31.5-15.2 49.4-15.2s34.4 5.1 49.4 15.1c15 10.1 26.6 23.3 34.6 39.7 10.3-4.2 21.1-6.3 32.6-6.3 25.5 0 47.3 9.5 65.4 28.6s27.1 42.1 27.1 69.1c0 12.6-1.9 24-5.7 34.3 16 7.6 28.8 19.3 38.3 35.1 9.5 15.9 14.3 33.4 14.3 52.4zm-266.9 77.1 105.7-158.3c2.7-4.2 3.5-8.8 2.6-13.7-1-4.9-3.5-8.8-7.7-11.4-4.2-2.7-8.8-3.6-13.7-2.9-5 .8-9 3.2-12 7.4l-93.1 140-42.9-42.8c-3.8-3.8-8.2-5.6-13.1-5.4-5 .2-9.3 2-13.1 5.4-3.4 3.4-5.1 7.7-5.1 12.9 0 5.1 1.7 9.4 5.1 12.9l58.9 58.9 2.9 2.3c3.4 2.3 6.9 3.4 10.3 3.4 6.7-.1 11.8-2.9 15.2-8.7z"fill="#1da1f2"></path></svg>`,t=e=>{function r(e,t){var n=window.getComputedStyle(t);return parseFloat(n["margin"+e])||0}function l(e){return e+"px"}function j(e){return parseFloat(e.style.top)}function d(e){return parseFloat(e.style.left)}function c(e){return e.clientWidth}function b(e){return e.clientHeight}function a(e){return j(e)+b(e)+r("Bottom",e)}function f(e){return d(e)+c(e)+r("Right",e)}function p(e){e=e.sort(function(e,t){return a(e)===a(t)?d(t)-d(e):a(t)-a(e)})}function g(n){c(e)!=v&&(n.target.removeEventListener(n.type,arguments.callee),t(e))}"string"==typeof e&&(e=document.querySelector(e)),n=[].map.call(e.children,function(e){return e.style.position="absolute",e}),e.style.position="relative",i=[],n.length&&(n[0].style.top="0px",n[0].style.left=l(r("Left",n[0])),i.push(n[0]));for(o=1;o<n.length;o++){var n,o,i,h,m,v,u=n[o-1],s=n[o],y=f(u)+c(s)<=c(e);if(!y)break;s.style.top=u.style.top,s.style.left=l(f(u)+r("Left",s)),i.push(s)}for(;o<n.length;o++)p(i),s=n[o],h=i.pop(),s.style.top=l(a(h)+r("Top",s)),s.style.left=l(d(h)),i.push(s);p(i),m=i[0],e.style.height=l(a(m)+r("Bottom",m)),v=c(e),window.addEventListener?window.addEventListener("resize",g):document.body.onresize=g},s=()=>{const n=window.siteConfig?.topAnnouncement?.shuoshuo?.apiUrl||"";if(!n){console.warn("[è¯´è¯´é¡µé¢] æœªé…ç½®APIåœ°å€ï¼Œè¯·åœ¨ hugo.toml ä¸­é…ç½® params.topAnnouncement.shuoshuo.apiUrl"),e&&(e.innerHTML='<div class="shuoshuo-error">è¯·åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®è¯´è¯´APIåœ°å€</div>');return}const s="talksCache",a="talksCacheTime",u=30*60*1e3,r=localStorage.getItem(s),c=localStorage.getItem(a),l=(new Date).getTime();if(r&&c&&l-c<u){const e=JSON.parse(r);d(e)}else e&&(e.innerHTML="",fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:30})}).then(e=>e.json()).then(e=>{e.code===0&&e.data&&Array.isArray(e.data.list)&&(localStorage.setItem(s,JSON.stringify(e.data.list)),localStorage.setItem(a,l.toString()),d(e.data.list))}).catch(e=>{console.error("Error fetching data:",e)}));function d(n){if(Array.isArray(n)){n.forEach(t=>{const n=o(t);n.id=t.id;const s=i(n);e.appendChild(s)}),t("#talk");const a=new URLSearchParams(window.location.search),s=a.get("id");s&&setTimeout(()=>{const e=document.getElementById(`talk-${s}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.transition="all 0.3s ease",e.style.boxShadow="0 0 20px rgba(102, 126, 234, 0.5)",setTimeout(()=>{e.style.boxShadow=""},2e3))},500)}else console.error("Data is not an array:",n)}},o=e=>{let o=r(new Date(e.createdAt).toString()),t=e.content,s=e.imgs?e.imgs.split(","):[],i=t;if(t=i.replace(/\[(.*?)\]\((.*?)\)/g,`<a href="$2">@$1</a>`).replace(/- \[ \]/g,"âšª").replace(/- \[x\]/g,"âš«"),t=t.replace(/\n/g,"<br>"),t=`<div class="talk_content_text">${t}</div>`,s.length>0){const e=document.createElement("div");e.className="zone_imgbox",s.forEach(t=>{const n=document.createElement("a");n.href=t,n.setAttribute("data-fancybox","gallery"),n.className="fancybox",n.setAttribute("data-thumb",t);const s=document.createElement("img");s.src=t,n.appendChild(s),e.appendChild(n)}),t+=e.outerHTML}let n={};try{n=JSON.parse(e.ext||"{}")}catch{n={}}if(n.music&&n.music.id&&n.music.server&&n.music.type){const s=n.music,o=document.createElement("div");o.className="talk_music";const e=document.createElement("meting-js");e.setAttribute("server",s.server),e.setAttribute("type",s.type),e.setAttribute("id",s.id),s.api&&e.setAttribute("api",s.api),e.setAttribute("autoplay","false"),e.setAttribute("theme","#2980b9"),e.setAttribute("loop","all"),e.setAttribute("order","list"),e.setAttribute("volume","0.7"),o.appendChild(e),t+=o.outerHTML}if(n.video&&n.video.value&&n.video.type){const e=n.video;let s="";if(e.type==="bilibili"){const t=e.value.includes("?")?`${e.value}&high_quality=1&danmaku=0`:`${e.value}?high_quality=1&danmaku=0`;s=`
                    <div class="talk_video">
                        <div class="video-wrapper">
                            <iframe 
                                src="${t}" 
                                scrolling="no" 
                                border="0" 
                                frameborder="no" 
                                framespacing="0" 
                                allowfullscreen="true">
                            </iframe>
                        </div>
                    </div>
                `}else if(e.type==="youtube"){let t="";if(e.value.includes("youtube.com")){const n=e.value.match(/[?&]v=([^&]+)/);t=n?n[1]:""}else if(e.value.includes("youtu.be")){const n=e.value.match(/youtu\.be\/([^?]+)/);t=n?n[1]:""}t&&(s=`
                        <div class="talk_video">
                            <div class="video-wrapper">
                                <iframe 
                                    src="https://www.youtube.com/embed/${t}" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                                </iframe>
                            </div>
                        </div>
                    `)}else(e.type==="video"||e.type==="mp4")&&(s=`
                    <div class="talk_video">
                        <video 
                            controls 
                            preload="metadata"
                            style="width: 100%; max-height: 400px; border-radius: 8px; background: #000;">
                            <source src="${e.value}" type="video/mp4">
                            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
                        </video>
                    </div>
                `);s&&(t+=s)}return{content:t,user:e.user.nickname||"åŒ¿å",avatar:e.user.avatarUrl||"https://p.liiiu.cn/i/2024/03/29/66061417537af.png",date:o,location:e.location||"ç§¦çš‡å²›",tags:e.tags?e.tags.split(",").filter(e=>e.trim()!==""):["æ— æ ‡ç­¾"],text:t.replace(/\[(.*?)\]\((.*?)\)/g,`[é“¾æ¥]${s.length?"[å›¾ç‰‡]":""}`)}},i=e=>{const t=document.createElement("div");t.className="talk_item",e.id&&(t.id=`talk-${e.id}`,t.setAttribute("data-talk-id",e.id));const s=document.createElement("div");s.className="talk_meta";const f=document.createElement("img");f.className="no-lightbox avatar",f.src=e.avatar;const i=document.createElement("div");i.className="info";const d=document.createElement("span");d.className="talk_nick",d.innerHTML=`${e.user} ${n()}`;const l=document.createElement("span");l.className="talk_date",l.textContent=e.date;const c=document.createElement("div");c.className="talk_content",c.innerHTML=e.content;const r=document.createElement("div");r.className="talk_bottom";const u=document.createElement("div"),h=document.createElement("span");h.className="talk_tag",h.textContent=`ğŸ·ï¸${e.tags[0]||"æ— æ ‡ç­¾"}`;const m=document.createElement("span");m.className="location_tag",m.textContent=`ğŸŒ${e.location}`,u.appendChild(h),u.appendChild(m);const o=document.createElement("a");o.href="javascript:;",o.onclick=()=>a(e.text);const p=document.createElement("span");p.className="icon";const g=document.createElement("i");return g.className="fa-solid fa-message fa-fw",p.appendChild(g),o.appendChild(p),s.appendChild(f),i.appendChild(d),i.appendChild(l),s.appendChild(i),t.appendChild(s),t.appendChild(c),r.appendChild(u),r.appendChild(o),t.appendChild(r),t},a=e=>{const t=e.match(/<div class="talk_content_text">([\s\S]*?)<\/div>/),s=t?t[1]:"",n=document.querySelector("#artalk-comment");n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{const e=document.querySelector(".atk-textarea");e&&(e.value=`> ${s}

`,e.focus(),window.btf&&window.btf.snackbarShow&&window.btf.snackbarShow("å·²ä¸ºæ‚¨å¼•ç”¨è¯¥è¯´è¯´ï¼Œä¸åˆ é™¤ç©ºæ ¼æ•ˆæœæ›´ä½³"))},500))},r=e=>{const t=new Date(e),s=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()],n=s.map(e=>e.toString().length===1?"0"+e:e);return`${n[0]}-${n[1]}-${n[2]} ${n[3]}:${n[4]}`};s()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):y(),window.renderTalks=y,function(){"use strict";function e(){if(window.innerWidth>768)return;let e=document.querySelector(".mobile-nav-button");if(!e){e=document.createElement("button"),e.className="mobile-nav-button",e.innerHTML="<span></span><span></span><span></span>",e.setAttribute("aria-label","èœå•");const t=document.querySelector(".site-header");t&&t.appendChild(e)}let t=document.querySelector(".mobile-nav-overlay");t||(t=document.createElement("div"),t.className="mobile-nav-overlay",document.body.appendChild(t));const n=document.querySelector(".site-nav-main");if(!n)return;n.classList.remove("mobile-nav-open","mobile-open"),e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="",e.addEventListener("click",function(e){e.stopPropagation(),i()}),t.addEventListener("click",s);function i(){e.classList.toggle("active"),n.classList.toggle("mobile-nav-open"),t.classList.toggle("active"),n.classList.contains("mobile-nav-open")?document.body.style.overflow="hidden":document.body.style.overflow=""}function s(){e.classList.remove("active"),n.classList.remove("mobile-nav-open"),t.classList.remove("active"),document.body.style.overflow=""}const o=document.querySelectorAll(".nav-item-dropdown");o.forEach(e=>{const t=e.querySelector(".nav-link-main");if(t){const n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),n.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),o.forEach(t=>{t!==e&&t.classList.remove("mobile-open")}),e.classList.toggle("mobile-open")})}});const a=n.querySelectorAll(".nav-link-main, .nav-dropdown-link");a.forEach(e=>{(!e.closest(".nav-item-dropdown")||e.classList.contains("nav-dropdown-link"))&&e.addEventListener("click",function(){setTimeout(s,200)})})}function s(){const e=document.querySelector(".mobile-nav-button");e&&e.remove();const t=document.querySelector(".mobile-nav-overlay");t&&t.remove(),document.body.style.overflow="";const n=document.querySelectorAll(".mobile-open, .mobile-nav-open");n.forEach(e=>{e.classList.remove("mobile-open","mobile-nav-open")});const s=document.querySelectorAll(".mobile-nav-button.active, .mobile-nav-overlay.active");s.forEach(e=>e.classList.remove("active"))}function t(){if(window.innerWidth>768)return;const e=document.querySelector(".site-header");if(!e)return;let t=0,o=10,n=!1;function a(){if(n)return;n=!0,requestAnimationFrame(()=>{const s=window.pageYOffset||document.documentElement.scrollTop;s>50?e.classList.add("header-scrolled"):e.classList.remove("header-scrolled"),s<=100?(document.body.classList.add("at-top"),e.classList.remove("header-hidden"),e.classList.add("header-visible")):(document.body.classList.remove("at-top"),s>t+o?(e.classList.add("header-hidden"),e.classList.remove("header-visible")):s<t-o&&(e.classList.remove("header-hidden"),e.classList.add("header-visible"))),t=s<=0?0:s,n=!1})}let s;window.addEventListener("scroll",function(){s&&clearTimeout(s),s=setTimeout(a,10)},{passive:!0});const i=window.pageYOffset||document.documentElement.scrollTop;i<=100&&document.body.classList.add("at-top"),i>50&&e.classList.add("header-scrolled")}function n(){if(window.innerWidth>768)return;const i=window.location.pathname,l=i==="/"||i==="/index.html"||i.startsWith("/page/");if(l)return;const n=document.querySelector(".site-aside-right");if(!n)return;const d=n.querySelector(".aside-card, .toc-content, .toc-widget, .aside-title");if(!d)return;let e=document.querySelector(".mobile-toc-button");if(!e){e=document.createElement("button"),e.className="mobile-toc-button floating-btn",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',e.setAttribute("aria-label","ç›®å½•");const t=document.querySelector(".floating-buttons");t?t.appendChild(e):document.body.appendChild(e)}const a=window.siteConfig&&window.siteConfig.mobileTocPopupMode||"sidebar";let s=document.querySelector(".mobile-toc-overlay");s||(s=document.createElement("div"),s.className="mobile-toc-overlay",document.body.appendChild(s));let t=null;if(a==="toc-only"){{t=document.querySelector(".mobile-toc-only-container"),t||(t=document.createElement("div"),t.className="mobile-toc-only-container",document.body.appendChild(t)),t.innerHTML="";const e=n.querySelector('.toc-card, .toc-widget, [class*="toc"]');if(e){const s=e.cloneNode(!0),n=document.createElement("button");n.className="mobile-toc-only-close",n.innerHTML='<i class="fas fa-times"></i>',n.setAttribute("aria-label","å…³é—­"),t.appendChild(n),t.appendChild(s)}}}else{let e=n.querySelector(".mobile-toc-close");e||(e=document.createElement("button"),e.className="mobile-toc-close",e.innerHTML='<i class="fas fa-times"></i>',e.setAttribute("aria-label","å…³é—­"),n.insertBefore(e,n.firstChild))}const r=e.cloneNode(!0);e.parentNode.replaceChild(r,e),e=r;const c=s.cloneNode(!0);s.parentNode.replaceChild(c,s),s=c;function o(){const t=window.siteConfig&&window.siteConfig.mobileTocPopupMode||"sidebar";if(t==="toc-only"){const e=document.querySelector(".mobile-toc-only-container");e&&e.classList.remove("mobile-toc-only-open")}else{const e=document.querySelector(".site-aside-right");e&&e.classList.remove("mobile-toc-open")}const e=document.querySelector(".mobile-toc-overlay");e&&e.classList.remove("active"),document.body.style.overflow=""}if(e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const t=window.siteConfig&&window.siteConfig.mobileTocPopupMode||"sidebar";if(t==="toc-only"){let e=document.querySelector(".mobile-toc-only-container");e||(e=document.createElement("div"),e.className="mobile-toc-only-container",document.body.appendChild(e)),e.innerHTML="";const t=document.querySelector(".site-aside-right");if(t){const n=t.querySelector('.toc-card, .toc-widget, [class*="toc"]');if(n){const s=n.cloneNode(!0),t=document.createElement("button");t.className="mobile-toc-only-close",t.innerHTML='<i class="fas fa-times"></i>',t.setAttribute("aria-label","å…³é—­"),e.appendChild(t),e.appendChild(s),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),o()});const i=e.querySelectorAll(".toc-content a, .toc-widget a");i.forEach(e=>{e.addEventListener("click",function(){setTimeout(o,300)})})}}const n=e&&e.classList.contains("mobile-toc-only-open");if(n)o();else{e&&e.classList.add("mobile-toc-only-open");const t=document.querySelector(".mobile-toc-overlay");t&&t.classList.add("active"),document.body.style.overflow="hidden"}}else{const e=document.querySelector(".site-aside-right"),t=e&&e.classList.contains("mobile-toc-open");if(t)o();else{e&&e.classList.add("mobile-toc-open");const t=document.querySelector(".mobile-toc-overlay");t&&t.classList.add("active"),document.body.style.overflow="hidden"}}}),s.addEventListener("click",function(){o()}),a==="toc-only"){if(t){const e=t.querySelector(".mobile-toc-only-close");if(e){const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),o()})}const n=t.querySelectorAll(".toc-content a, .toc-widget a");n.forEach(e=>{e.addEventListener("click",function(){setTimeout(o,300)})}),t.addEventListener("click",function(e){e.stopPropagation()})}}else{const e=n.querySelector(".mobile-toc-close");if(e){const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),o()})}n.addEventListener("click",function(e){e.stopPropagation()});const t=n.querySelectorAll(".toc-content a, .toc-widget a");t.forEach(e=>{e.addEventListener("click",function(){setTimeout(o,300)})})}}function o(){const e=document.querySelector(".mobile-toc-button");e&&e.remove();const t=document.querySelector(".mobile-toc-overlay");t&&t.remove();const n=document.querySelector(".mobile-toc-close");n&&n.remove();const s=document.querySelector(".mobile-toc-only-container");s&&s.remove();const o=document.querySelector(".site-aside-right");o&&o.classList.remove("mobile-toc-open")}function i(){document.body.classList.remove("at-top");const e=document.querySelector(".site-header");e&&e.classList.remove("header-hidden","header-visible","header-scrolled")}let a;window.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(function(){window.innerWidth>768?(s(),i(),o()):(s(),i(),o(),e(),t(),n())},250)}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){e(),t(),n()}):(e(),t(),n()),window.initMobileNavigation=e,window.cleanupMobile=s,window.initHeaderScrollBehavior=t,window.cleanupHeaderScrollBehavior=i,window.initMobileToc=n,window.cleanupMobileToc=o}(),document.addEventListener("DOMContentLoaded",function(){L();const e=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-theme"&&ke()})});e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})});function L(){const t=document.body,n=e("siteBackgroundEnabled")==="true",s=e("homeCoverEnabled")==="true",o=e("effectMode")||"glass";if(n){const e=document.createElement("div");e.className="site-background",e.id="site-background",t.appendChild(e),N()}s&&Ae()?t.classList.add("home-cover-enabled"):t.classList.add("home-cover-disabled"),n?t.classList.add("background-enabled"):t.classList.add("background-disabled"),W(o)}function N(){const t=document.getElementById("site-background");if(!t)return;const e=ne();document.documentElement.style.setProperty("--home-cover-image",`url('${e.homeCover.image}')`),document.documentElement.style.setProperty("--site-background-image",`url('${e.site.image}')`),document.documentElement.style.setProperty("--background-blur",`${e.site.blur}px`),document.documentElement.style.setProperty("--background-brightness",`${e.site.brightness}%`),document.documentElement.style.setProperty("--background-opacity",`${e.site.opacity/100}`)}function ne(){return{site:{enable:e("siteBackgroundEnabled"),image:e("siteBackgroundImage")||"https://images.unsplash.com/photo-1497366216548-37526070297c",blur:parseInt(e("siteBackgroundBlur"))||0,brightness:parseInt(e("siteBackgroundBrightness"))||100,opacity:parseInt(e("siteBackgroundOpacity"))||80},homeCover:{enable:e("homeCoverEnabled"),image:e("homeCoverImage")||"https://images.unsplash.com/photo-1506744038136-46273834b3fb",title:e("homeCoverTitle")||document.title,subtitle:e("homeCoverSubtitle")||""},effectMode:e("effectMode")||"glass"}}function e(e){const t=window.siteConfig||{};return t[e]}function Ae(){return window.location.pathname==="/"||window.location.pathname==="/index.html"}function ke(){const t=document.documentElement.getAttribute("data-theme"),e=document.getElementById("site-background");e&&(t==="dark"?e.style.filter="brightness(0.8)":e.style.filter="brightness(1)")}function W(t){const n=document.querySelector(".site-wrap");if(!n)return;if(n.classList.remove("effect-transparent","effect-glass","effect-translucent","effect-solid"),n.classList.add(`effect-${t}`),t==="solid"){const t=e("solidColor")||"#4fc3f7";n.style.backgroundColor=t}else n.style.backgroundColor=""}window.backgroundManager={toggleSiteBackground:function(e){const t=document.body,n=document.getElementById("site-background");e?(n||L(),t.classList.remove("background-disabled"),t.classList.add("background-enabled")):(n&&n.remove(),t.classList.remove("background-enabled"),t.classList.add("background-disabled"))},toggleHomeCover:function(e){const t=document.body;e?(t.classList.remove("home-cover-disabled"),t.classList.add("home-cover-enabled")):(t.classList.remove("home-cover-enabled"),t.classList.add("home-cover-disabled"))},updateBackgroundConfig:function(){N()},switchEffectMode:function(e){W(e)}};function z(){_()}document.addEventListener("DOMContentLoaded",z),window.initHomeBigImage=z;function _(){const n=t("homeBigImageEnabled")==="true",e=t("homeBigImageMode")||"mode1";if(!n)return;Ee(),e==="mode1"?Oe():e==="mode2"&&_e()}function Ee(){const n=t("homeBigImageMode1BackgroundImage"),i=t("homeBigImageMode2OverlayOpacity")||"0.3",e=t("siteBackgroundImage"),s=t("siteBackgroundEnabled")==="true",a=t("siteBackgroundBlur")||"0",r=t("siteBackgroundBrightness")||"100",c=t("siteBackgroundOpacity")||"80",l=t("homeBigImageMode2CustomBackgroundImage");n&&document.documentElement.style.setProperty("--home-big-image-mode1-bg",`url('${n}')`);let o=l;o?(document.documentElement.style.setProperty("--mode2-big-image-bg",`url('${o}')`),e&&s?document.documentElement.style.setProperty("--site-background-image",`url('${e}')`):document.documentElement.style.setProperty("--site-background-image","none")):e&&s?(document.documentElement.style.setProperty("--mode2-big-image-bg",`url('${e}')`),document.documentElement.style.setProperty("--site-background-image",`url('${e}')`)):(document.documentElement.style.setProperty("--mode2-big-image-bg","none"),document.documentElement.style.setProperty("--site-background-image","none")),document.documentElement.style.setProperty("--background-blur",`${a}px`),document.documentElement.style.setProperty("--background-brightness",`${r}%`),document.documentElement.style.setProperty("--background-opacity",`${c/100}`),document.documentElement.style.setProperty("--home-big-image-overlay-opacity",i);const d=t("homeBigImageMode1CardAnimationSpeed")||"normal",u={slow:"1.2s",normal:"0.8s",fast:"0.4s"};document.documentElement.style.setProperty("--card-animation-duration",u[d]||"0.8s")}function Oe(){const e=document.getElementById("homeBigImageMode1"),n=document.getElementById("homeContentMode1");if(!e||!n)return;const o=window.location.pathname!=="/"&&window.location.pathname!=="/index.html",i=sessionStorage.getItem("homeBigImageSwitched")==="true";let s=!1;const a=t("homeBigImageMode1CardAnimation")==="true";o||i?(s=!0,e.style.transition="none",n.style.transition="none",e.classList.remove("active"),n.classList.add("active"),e.offsetHeight):(s=!1,e.classList.add("active"),n.classList.remove("active"),document.body.classList.add("home-big-image-active")),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r()});function r(){s?l():c()}function c(){s=!0,e.classList.remove("active"),n.classList.add("active"),document.body.classList.remove("home-big-image-active"),sessionStorage.setItem("homeBigImageSwitched","true"),a&&setTimeout(()=>{d()},100)}function l(){s=!1,n.classList.remove("active"),e.classList.add("active"),document.body.classList.add("home-big-image-active"),sessionStorage.removeItem("homeBigImageSwitched")}function d(){const t=u(),e=[{x:-200,y:-200,rotate:-15},{x:0,y:-250,rotate:0},{x:200,y:-200,rotate:15},{x:-250,y:0,rotate:-20},{x:250,y:0,rotate:20},{x:-200,y:200,rotate:-10},{x:0,y:250,rotate:0},{x:200,y:200,rotate:10}],n=window.innerWidth/2,s=window.innerHeight/2;t.forEach((t,o)=>{t.style.opacity="0",t.style.transform="scale(0.8)",t.style.transition="none";const i=t.getBoundingClientRect(),r=i.left+i.width/2,c=i.top+i.height/2,l=o%e.length,a=e[l],m=r-n,f=c-s,d=a.x,u=a.y,h=a.rotate;t.style.transform=`translate(${d}px, ${u}px) rotate(${h}deg) scale(0.8)`,setTimeout(()=>{t.style.transition="all var(--card-animation-duration, 0.8s) cubic-bezier(0.4, 0, 0.2, 1)",t.style.opacity="1",t.style.transform="translate(0, 0) rotate(0deg) scale(1)"},o*80)})}function u(){const t=document.querySelectorAll(".home-content-mode1 .post-item, .home-content-mode1 .post-card, .home-content-mode1 .article-card, .home-content-mode1 .card"),e=[],n=window.innerHeight||document.documentElement.clientHeight;return t.forEach(t=>{const s=t.getBoundingClientRect();s.top<n&&s.bottom>0&&e.push(t)}),e}}function _e(){const e=document.getElementById("homeBigImageMode2"),t=document.getElementById("homeContentMode2"),o=document.querySelector(".home-big-image-scroll-arrow");if(!e||!t)return;const a=window.location.pathname.includes("/page/")||window.location.pathname!=="/"&&window.location.pathname!=="/index.html",r=sessionStorage.getItem("homeBigImageSwitched")==="true",c=sessionStorage.getItem("pjaxToHomePage")==="true";let n=!1;if(a||r){n=!0,e.style.transition="none",t.style.transition="none",e.classList.add("scrolled"),t.classList.add("visible"),e.offsetHeight;return}c?(e.style.transition="none",t.style.transition="none",e.classList.remove("scrolled"),t.classList.remove("visible"),document.body.classList.add("home-big-image-active"),e.offsetHeight,requestAnimationFrame(()=>{e.style.transition="",t.style.transition=""})):(e.classList.remove("scrolled"),t.classList.remove("visible"),document.body.classList.add("home-big-image-active")),o&&o.addEventListener("click",function(){i()});let s=null;window.addEventListener("scroll",function(){s!==null&&clearTimeout(s),s=setTimeout(function(){l()},10)});function l(){const e=window.pageYOffset||document.documentElement.scrollTop;e>20&&!n&&i()}function i(){if(n)return;n=!0,e.classList.add("scrolled"),t.classList.add("visible"),sessionStorage.setItem("homeBigImageSwitched","true"),setTimeout(()=>{document.body.classList.remove("home-big-image-active")},800),window.scrollTo({top:0,behavior:"smooth"})}je()}function je(){const e=document.querySelector(".home-big-image-content");e&&document.addEventListener("mousemove",function(t){const n=t.clientX/window.innerWidth*100,s=t.clientY/window.innerHeight*100;e.style.transform=`translate(${n*.02}px, ${s*.02}px)`})}function t(e){return typeof window.siteConfig=="undefined"?null:window.siteConfig[e]}window.homeBigImageManager={switchMode:function(e){const n=t("homeBigImageMode");if(n===e)return;window.siteConfig&&(window.siteConfig.homeBigImageMode=e),_()},updateBackgroundImage:function(e){window.siteConfig&&(window.siteConfig.homeBigImageMode1BackgroundImage=e),document.documentElement.style.setProperty("--home-big-image-mode1-bg",`url('${e}')`)},updateContent:function(e,t){const n=document.querySelectorAll(".home-big-image-title"),s=document.querySelectorAll(".home-big-image-subtitle");n.forEach(t=>t.textContent=e),s.forEach(e=>e.textContent=t),window.siteConfig&&(window.siteConfig.homeBigImageTitle=e,window.siteConfig.homeBigImageSubtitle=t)},toggle:function(e){if(window.siteConfig&&(window.siteConfig.homeBigImageEnabled=e.toString()),e)_();else{const e=document.getElementById("homeBigImageMode1"),t=document.getElementById("homeBigImageMode2");e&&(e.style.display="none"),t&&(t.style.display="none")}}};function D(){const c=window.siteConfig?.typewriterEnable==="true",l=window.siteConfig?.homeBigImageEnabled==="true",d=window.siteConfig?.homeBigImageMode||"mode1";if(!c||!l||d!=="mode2")return;if(window.location.pathname!=="/"&&window.location.pathname!=="/index.html")return;const e=document.querySelector(".home-big-image-mode2 .home-big-image-subtitle");if(!e)return;const u=parseInt(window.siteConfig?.typewriterSpeed||"100",10),o=parseInt(window.siteConfig?.typewriterDelay||"1000",10),i=window.siteConfig?.typewriterCursor==="true",a=window.siteConfig?.typewriterLoop==="true",r=e.textContent;e.textContent="",i&&e.classList.add("typewriter-cursor");let t=0,n=null;function s(){t<r.length?(e.textContent=r.substring(0,t+1),t++,n=setTimeout(s,u)):i&&!a?setTimeout(()=>{e.classList.remove("typewriter-cursor")},500):a&&setTimeout(()=>{t=0,e.textContent="",s()},o*2)}setTimeout(()=>{s()},o),window.cleanupTypewriter=function(){n&&(clearTimeout(n),n=null)}}document.addEventListener("DOMContentLoaded",D),window.initTypewriter=D,function(){"use strict";let e=null,t=-1,n=-1,s=!1;function i(){const n=document.querySelector(".gallery-page");if(!n)return;const t=document.getElementById("gallery-data");if(!t)return;try{e=JSON.parse(t.textContent)}catch(e){console.error("è§£æç›¸å†Œæ•°æ®å¤±è´¥:",e);return}g(),f(),m(),d()}function g(){const e=document.querySelectorAll(".gallery-album-card");e.forEach((e)=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const t=parseInt(this.dataset.albumIndex);p(t)})})}function p(n){if(!e||!e.groups||!e.groups[n])return;t=n;const o=e.groups[n],i=document.getElementById("gallery-detail-title"),a=document.getElementById("gallery-detail-desc"),r=document.getElementById("gallery-detail-count");i&&(i.textContent=o.name),a&&(a.textContent=o.description),r&&(r.textContent=`${o.photos.length} å¼ ç…§ç‰‡`);const c=document.getElementById("gallery-albums-view"),s=document.getElementById("gallery-detail-view");c&&(c.style.display="none"),s&&(s.style.display="block");const u=s.querySelectorAll(".gallery-photos-grid");u.forEach(e=>{e.style.display="none"});const l=s.querySelector(`.gallery-photos-grid[data-album-index="${n}"]`);l&&(l.style.display="grid"),window.scrollTo({top:0,behavior:"smooth"}),d()}function f(){const e=document.getElementById("gallery-back-btn");e&&e.addEventListener("click",u)}function u(){const e=document.getElementById("gallery-albums-view"),n=document.getElementById("gallery-detail-view");e.style.display="block",n.style.display="none",t=-1,window.scrollTo({top:0,behavior:"smooth"})}function d(){const e=document.querySelectorAll(".gallery-photo-item");e.forEach(e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(){const e=parseInt(this.dataset.photoIndex);h(e)})})}function m(){const e=document.getElementById("gallery-lightbox"),t=document.querySelector(".gallery-lightbox-close"),n=document.querySelector(".gallery-lightbox-prev"),s=document.querySelector(".gallery-lightbox-next");if(!e)return;t&&t.addEventListener("click",o),e.addEventListener("click",function(t){t.target===e&&o()}),n&&n.addEventListener("click",function(e){e.stopPropagation(),l()}),s&&s.addEventListener("click",function(e){e.stopPropagation(),c()}),document.addEventListener("keydown",a)}function a(e){if(!s)return;switch(e.key){case"Escape":o();break;case"ArrowLeft":l();break;case"ArrowRight":c();break}}function h(o){if(t<0||!e)return;const a=e.groups[t];if(!a||!a.photos[o])return;n=o;const i=a.photos[o],r=document.getElementById("gallery-lightbox"),c=document.getElementById("lightbox-img"),l=document.getElementById("lightbox-title"),d=document.getElementById("lightbox-description"),u=document.getElementById("lightbox-date");c&&(c.src=i.url),l&&(l.textContent=i.title),d&&(d.textContent=i.description),u&&(u.textContent=i.date),r&&(r.classList.add("active"),s=!0,document.body.style.overflow="hidden")}function o(){const e=document.getElementById("gallery-lightbox");e&&(e.classList.remove("active"),s=!1,document.body.style.overflow="")}function l(){if(t<0||!e)return;const s=e.groups[t];if(!s)return;n--,n<0&&(n=s.photos.length-1),r()}function c(){if(t<0||!e)return;const s=e.groups[t];if(!s)return;n++,n>=s.photos.length&&(n=0),r()}function r(){if(t<0||!e)return;const i=e.groups[t];if(!i||!i.photos[n])return;const s=i.photos[n],o=document.getElementById("lightbox-img"),a=document.getElementById("lightbox-title"),r=document.getElementById("lightbox-description"),c=document.getElementById("lightbox-date");o&&(o.style.opacity="0",setTimeout(()=>{o.src=s.url,o.style.opacity="1"},150)),a&&(a.textContent=s.title),r&&(r.textContent=s.description),c&&(c.textContent=s.date)}function v(){o(),t=-1,n=-1,s=!1,e=null,document.removeEventListener("keydown",a),document.body.style.overflow=""}window.initGallery=i,window.cleanupGallery=v,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()}();function A(){const t=document.querySelector(".carousel-container");if(!t)return;const e=t.querySelector(".carousel-track"),r=t.querySelectorAll(".carousel-item"),b=t.querySelector(".carousel-nav-prev"),y=t.querySelector(".carousel-nav-next"),j=t.querySelectorAll(".carousel-indicator");if(!e||r.length===0)return;const g=t.dataset.autoplay==="true",E=parseInt(t.dataset.interval)||5e3,o=t.dataset.direction||"horizontal";let n=0,i=null,u=!1,p=0,a=0,h=0;function C(){s(0,!1),g&&m(),b&&b.addEventListener("click",v),y&&y.addEventListener("click",d),j.forEach((e,t)=>{e.addEventListener("click",()=>x(t))}),e.addEventListener("mousedown",_),e.addEventListener("touchstart",_),e.addEventListener("mouseup",f),e.addEventListener("touchend",f),e.addEventListener("mouseleave",f),e.addEventListener("mousemove",w),e.addEventListener("touchmove",w),t.addEventListener("mouseenter",l),t.addEventListener("mouseleave",()=>{g&&m()}),document.addEventListener("keydown",O)}function s(t,s=!0){n=t,s?e.style.transition="transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)":e.style.transition="none",o==="horizontal"?e.style.transform=`translateX(-${n*100}%)`:e.style.transform=`translateY(-${n*100}%)`,j.forEach((e,t)=>{t===n?e.classList.add("active"):e.classList.remove("active")}),h=-n*100}function v(){const e=n===0?r.length-1:n-1;s(e),c()}function d(){const e=n===r.length-1?0:n+1;s(e),c()}function x(e){s(e),c()}function m(){if(i)return;i=setInterval(d,E)}function l(){i&&(clearInterval(i),i=null)}function c(){l(),g&&m()}function _(t){u=!0,o==="horizontal"?p=t.type.includes("mouse")?t.pageX:t.touches[0].clientX:p=t.type.includes("mouse")?t.pageY:t.touches[0].clientY,e.style.cursor="grabbing",l()}function w(n){if(!u)return;n.preventDefault();let s;o==="horizontal"?s=n.type.includes("mouse")?n.pageX:n.touches[0].clientX:s=n.type.includes("mouse")?n.pageY:n.touches[0].clientY;const r=s-p;let i;o==="horizontal"?i=r/t.offsetWidth*100:i=r/t.offsetHeight*100,a=h+i,o==="horizontal"?e.style.transform=`translateX(${a}%)`:e.style.transform=`translateY(${a}%)`}function f(){if(!u)return;u=!1,e.style.cursor="grab";const t=a-h;t<-20&&n<r.length-1?d():t>20&&n>0?v():s(n),c()}function O(e){if(!k())return;e.key==="ArrowLeft"||e.key==="ArrowUp"?v():(e.key==="ArrowRight"||e.key==="ArrowDown")&&d()}function k(){const e=t.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}window.cleanupCarousel=function(){l(),document.removeEventListener("keydown",O)},C()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",A):A(),window.initCarousel=A;function S(){if(!window.siteConfig||!window.siteConfig.stickyHeader)return;const e=document.querySelector(".site-header");if(!e)return;let s=0,o=e.offsetHeight;function i(){const t=window.pageYOffset||document.documentElement.scrollTop,n=document.querySelector(".home-big-image-mode2.active")||document.body.classList.contains("home-big-image-active");if(n){e.classList.contains("sticky")&&(e.classList.remove("sticky"),document.body.classList.remove("header-fixed"));return}t>o?e.classList.contains("sticky")||(e.classList.add("sticky"),document.body.classList.add("header-fixed")):e.classList.contains("sticky")&&(e.classList.remove("sticky"),document.body.classList.remove("header-fixed")),s=t}let t=!1;function n(){t||(window.requestAnimationFrame(function(){i(),t=!1}),t=!0)}window.addEventListener("scroll",n,{passive:!0}),window.cleanupStickyHeader=function(){window.removeEventListener("scroll",n),e.classList.remove("sticky"),document.body.classList.remove("header-fixed")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S(),window.initStickyHeader=S;function M(){const e=document.querySelector(".series-posts-widget");if(!e)return;const g=e.getAttribute("data-carousel")==="true";if(!g)return;const p=parseInt(e.getAttribute("data-interval"))||8e3,t=e.querySelectorAll(".series-item"),r=e.querySelectorAll(".series-indicator"),d=e.querySelector(".series-prev"),l=e.querySelector(".series-next");if(t.length<=1)return;let s=0,a=null,n=!1;function m(){const e=document.querySelector("article.post");if(!e)return-1;const n=window.location.pathname;for(let e=0;e<t.length;e++){const s=t[e],o=s.querySelectorAll(".series-post-item");for(let s of o){const t=s.getAttribute("href");if(t&&n.includes(t))return e}}return-1}const u=m();u!==-1&&(s=u,n=!0);function c(e){e<0&&(e=t.length-1),e>=t.length&&(e=0),t.forEach(e=>e.classList.remove("active")),r.forEach(e=>e.classList.remove("active")),t[e].classList.add("active"),r[e]&&r[e].classList.add("active"),s=e}function h(){c(s+1)}function f(){c(s-1)}function i(){if(n)return;o(),a=setInterval(h,p)}function o(){a&&(clearInterval(a),a=null)}n||r.forEach((e,t)=>{e.addEventListener("click",()=>{c(t),o(),i()})}),d&&!n&&d.addEventListener("click",()=>{f(),o(),i()}),l&&!n&&l.addEventListener("click",()=>{h(),o(),i()}),n||(e.addEventListener("mouseenter",o),e.addEventListener("mouseleave",i)),c(s),n||i()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",M):M(),typeof window.initSeriesPostsCarousel=="undefined"&&(window.initSeriesPostsCarousel=M);function F(){const t=document.getElementById("rewardButton"),e=document.getElementById("rewardPanel");if(!t||!e)return;let n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(n){let n=!1;t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n?(e.style.opacity="0",e.style.visibility="hidden",e.style.transform="translateX(-50%) translateY(-10px)",n=!1):(e.style.opacity="1",e.style.visibility="visible",e.style.transform="translateX(-50%) translateY(0)",n=!0)}),document.addEventListener("click",function(s){n&&!t.contains(s.target)&&!e.contains(s.target)&&(e.style.opacity="0",e.style.visibility="hidden",e.style.transform="translateX(-50%) translateY(-10px)",n=!1)}),e.addEventListener("click",function(e){e.stopPropagation()})}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",F):F(),typeof window.initReward=="undefined"&&(window.initReward=F),function(){"use strict";class o{constructor(){this.likeButton=document.getElementById("likeButton"),this.likeCount=document.getElementById("likeCount"),this.storageKey="post-likes",this.currentPostUrl="",this.likeButton&&(this.currentPostUrl=this.likeButton.getAttribute("data-post-url"),this.init())}init(){this.loadLikes(),this.likeButton.addEventListener("click",()=>this.toggleLike())}getAllLikes(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch{return{}}}saveLikes(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch{}}loadLikes(){const t=this.getAllLikes(),e=t[this.currentPostUrl]||{count:0,liked:!1};this.updateUI(e.count,e.liked)}toggleLike(){const t=this.getAllLikes(),e=t[this.currentPostUrl]||{count:0,liked:!1};e.liked?(e.count=Math.max(0,e.count-1),e.liked=!1):(e.count+=1,e.liked=!0),t[this.currentPostUrl]=e,this.saveLikes(t),this.updateUI(e.count,e.liked),e.liked&&this.playLikeAnimation()}updateUI(e,t){if(this.likeCount&&(this.likeCount.textContent=e),t){this.likeButton.classList.add("liked");const e=this.likeButton.querySelector(".action-text");e&&(e.textContent=window.siteConfig?.postActions?.like?.likedText||"å·²èµ")}else{this.likeButton.classList.remove("liked");const e=this.likeButton.querySelector(".action-text");e&&(e.textContent=window.siteConfig?.postActions?.like?.text||"ç‚¹èµ")}}playLikeAnimation(){const e=document.createElement("i");e.className="fas fa-heart",e.style.cssText=`
        position: fixed;
        left: ${event.clientX}px;
        top: ${event.clientY}px;
        color: #ff6b6b;
        font-size: 2rem;
        pointer-events: none;
        z-index: 9999;
        animation: floatHeart 1.5s ease-out forwards;
      `,document.body.appendChild(e),setTimeout(()=>e.remove(),1500)}destroy(){this.likeButton&&this.likeButton.removeEventListener("click",()=>this.toggleLike())}}if(!document.getElementById("like-animation-style")){const e=document.createElement("style");e.id="like-animation-style",e.textContent=`
      @keyframes floatHeart {
        0% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
        100% {
          opacity: 0;
          transform: translateY(-100px) scale(1.5);
        }
      }
    `,document.head.appendChild(e)}class i{constructor(){this.shareButton=document.getElementById("shareButton"),this.sharePanel=document.getElementById("sharePanel"),this.shareButton&&this.sharePanel&&this.init()}init(){const e=this.sharePanel.querySelectorAll(".share-platform-item");e.forEach(e=>{e.addEventListener("click",e=>this.handleShare(e))})}handleShare(e){e.preventDefault();const n=e.currentTarget.getAttribute("data-platform"),t=e.currentTarget.getAttribute("data-url"),s=encodeURIComponent(window.location.href),o=encodeURIComponent(document.title),i=encodeURIComponent(document.querySelector('meta[name="description"]')?.content||document.title);switch(n){case"å¾®ä¿¡":this.showWechatQRCode(window.location.href);break;case"å¤åˆ¶é“¾æ¥":this.copyLink(window.location.href);break;default:if(t){const e=t.replace("{url}",s).replace("{title}",o).replace("{description}",i);window.open(e,"_blank","width=600,height=400,menubar=no,toolbar=no")}break}}showWechatQRCode(e){let t=document.querySelector(".wechat-qrcode-popup");t&&t.remove(),t=document.createElement("div"),t.className="wechat-qrcode-popup",t.innerHTML=`
        <div class="qrcode-overlay"></div>
        <div class="qrcode-content">
          <div class="qrcode-header">
            <span>å¾®ä¿¡æ‰«ä¸€æ‰«åˆ†äº«</span>
            <button class="qrcode-close">&times;</button>
          </div>
          <div class="qrcode-body">
            <div id="wechatQRCode"></div>
            <p class="qrcode-tip">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆ</p>
          </div>
        </div>
      `,document.body.appendChild(t);const s=t.querySelector("#wechatQRCode"),n=document.createElement("img");n.src=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(e)}`,n.alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ",s.appendChild(n);const o=t.querySelector(".qrcode-close"),i=t.querySelector(".qrcode-overlay");if(o.addEventListener("click",()=>t.remove()),i.addEventListener("click",()=>t.remove()),!document.getElementById("wechat-qrcode-style")){const e=document.createElement("style");e.id="wechat-qrcode-style",e.textContent=`
          .wechat-qrcode-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
          }
          
          .qrcode-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            cursor: pointer;
          }
          
          .qrcode-content {
            position: relative;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 1;
          }
          
          .qrcode-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
          }
          
          .qrcode-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--text-color-light);
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            transition: color 0.3s ease;
          }
          
          .qrcode-close:hover {
            color: var(--accent);
          }
          
          .qrcode-body {
            text-align: center;
          }
          
          #wechatQRCode {
            display: inline-block;
            padding: 1rem;
            background: #fff;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
          }
          
          #wechatQRCode img {
            display: block;
            width: 200px;
            height: 200px;
          }
          
          .qrcode-tip {
            color: var(--text-color-light);
            font-size: 0.9rem;
            margin: 0;
          }
          
          [data-theme="dark"] .qrcode-content {
            background: var(--dark-card-bg);
          }
        `,document.head.appendChild(e)}}copyLink(e){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>this.showCopySuccess()).catch(()=>this.fallbackCopy(e)):this.fallbackCopy(e)}fallbackCopy(e){const t=document.createElement("textarea");t.value=e,t.style.cssText="position: fixed; left: -9999px; top: -9999px;",document.body.appendChild(t),t.select(),t.setSelectionRange(0,e.length);try{const e=document.execCommand("copy");e?this.showCopySuccess():this.showCopyFail()}catch{this.showCopyFail()}document.body.removeChild(t)}showCopySuccess(){const e=document.createElement("div");e.className="copy-success-tip",e.textContent="âœ“ é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",document.body.appendChild(e),setTimeout(()=>e.remove(),2e3)}showCopyFail(){const e=document.createElement("div");e.className="copy-success-tip",e.textContent="âœ— å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶",e.style.background="rgba(255, 0, 0, 0.8)",document.body.appendChild(e),setTimeout(()=>e.remove(),2e3)}destroy(){const e=this.sharePanel?.querySelectorAll(".share-platform-item");e?.forEach(e=>{e.removeEventListener("click",this.handleShare)})}}class a{constructor(){this.rewardButton=document.getElementById("rewardButton"),this.rewardPanel=document.getElementById("rewardPanel"),this.rewardButton&&this.rewardPanel&&this.init()}init(){}destroy(){}}let e,t,n;function s(){e=new o,t=new i,n=new a}function r(){e?.destroy(),t?.destroy(),n?.destroy(),e=null,t=null,n=null}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s(),window.siteConfig?.pjaxEnabled&&document.addEventListener("pjax:complete",()=>{r(),s()})}();function g(){const e=document.querySelectorAll(".tabs-container");if(!e.length)return;e.forEach(e=>{const s=e.querySelectorAll(".tab-button"),o=e.querySelectorAll(".tab-pane"),t=e.querySelector(".tabs-nav");B(t),s.forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-tab"),o=this.getAttribute("data-container"),e=document.getElementById(o);if(!e)return;const i=e.querySelectorAll(".tab-button"),a=e.querySelectorAll(".tab-pane");i.forEach(e=>e.classList.remove("active")),a.forEach(e=>e.classList.remove("active")),this.classList.add("active");const n=e.querySelector(`.tab-pane[data-tab="${t}"]`);if(n){n.classList.add("active");const t=e.getBoundingClientRect().top+window.pageYOffset-80;window.pageYOffset>t&&window.scrollTo({top:t,behavior:"smooth"})}const s=e.id;s&&sessionStorage.setItem(`tab-${s}`,t)})});const n=e.id;if(n){const t=sessionStorage.getItem(`tab-${n}`);if(t){const n=e.querySelector(`.tab-button[data-tab="${t}"]`);n&&n.click()}}window.addEventListener("resize",()=>{B(t)})})}function B(e){if(!e)return;e.scrollWidth>e.clientWidth?e.classList.add("has-scroll"):e.classList.remove("has-scroll")}function be(){const e=document.querySelectorAll(".tabs-container");e.forEach(e=>{const t=e.querySelectorAll(".tab-button");t.forEach(e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g(),window.initTabs=g,window.cleanupTabs=be,function(){"use strict";function t(){const t=document.querySelectorAll(".collapse-header");t.forEach(t=>{const n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),n.addEventListener("click",function(){e(this)}),n.addEventListener("keydown",function(t){(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(this))})})}function e(e){const n=e.closest(".collapse-container"),t=n.querySelector(".collapse-content"),s=e.classList.contains("active");s?(e.classList.remove("active"),t.classList.remove("show"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true")):(e.classList.add("active"),t.classList.add("show"),e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"))}function n(){const t=document.querySelectorAll(".collapse-header");t.forEach(t=>{t.classList.contains("active")||e(t)})}function s(){const t=document.querySelectorAll(".collapse-header");t.forEach(t=>{t.classList.contains("active")&&e(t)})}function o(t){const n=document.getElementById(t);if(n){const t=n.previousElementSibling;t&&t.classList.contains("collapse-header")&&(t.classList.contains("active")||e(t))}}function i(){}window.initCollapse=t,window.cleanupCollapse=i,window.expandAllCollapses=n,window.collapseAllCollapses=s,window.expandCollapseById=o,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}(),function(){"use strict";function e(){const e=document.querySelectorAll(".timeline-item");if(e.length===0)return;if("IntersectionObserver"in window){const s={threshold:.1,rootMargin:"0px 0px -50px 0px"},t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("timeline-item-visible"),t.unobserve(e.target))})},s);e.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(20px)",t.observe(e)});const n=document.createElement("style");n.textContent=`
        .timeline-item-visible {
          animation: fadeInUp 0.6s ease forwards !important;
          opacity: 1 !important;
          transform: translateY(0) !important;
        }
      `,document.head.appendChild(n)}e.forEach((e,t)=>{e.setAttribute("data-timeline-index",t+1)})}function t(){const e=document.querySelectorAll(".timeline-item");e.forEach(e=>{e.style.opacity="",e.style.transform="",e.classList.remove("timeline-item-visible")})}function n(){return document.querySelectorAll(".timeline-item")}function s(e){const t=document.querySelectorAll(".timeline-item");t.forEach(t=>{e==="all"||t.classList.contains(`timeline-item-${e}`)?t.style.display="":t.style.display="none"})}function o(){const e=document.querySelectorAll(".timeline-item");e.forEach(e=>{e.style.display=""})}window.initTimeline=e,window.cleanupTimeline=t,window.getAllTimelineItems=n,window.filterTimelineByType=s,window.resetTimelineFilter=o,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}(),window.initMusicPlayers=function(){},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",window.initMusicPlayers):window.initMusicPlayers(),E="demius_reply_visible_items",f="demius_reply_visible_pending";function O(){const e=document.querySelectorAll(".reply-visible-container");if(e.length===0)return;const t=V();e.forEach(e=>{const s=e.id;t.includes(s)&&o(e,!1);const n=e.querySelector(".reply-visible-button");n&&n.addEventListener("click",()=>ge(e))})}function ge(e){const n=e.id;if(!pe()){o(e,!0),i(n);return}const t=p();t?(t.scrollIntoView({behavior:"smooth",block:"start"}),t.classList.add("highlight-comment"),setTimeout(()=>{t.classList.remove("highlight-comment")},2e3),a("è¯·å…ˆå‘è¡¨è¯„è®ºï¼Œè¯„è®ºæˆåŠŸåå³å¯æŸ¥çœ‹éšè—å†…å®¹"),ae(n),se(e)):(o(e,!0),i(n))}function pe(){return p()!==null}function p(){const e=["#artalk",".artalk","#comments",".comments","#comment-container",".comment-container","#gitalk-container","#disqus_thread","#valine","#twikoo","#waline","#utterances","#giscus"];for(const n of e){const t=document.querySelector(n);if(t)return t}return null}function o(e,t=!0){const n=e.querySelector(".reply-visible-mask"),s=e.querySelector(".reply-visible-content");if(!n||!s)return;e.dataset.visible="true",t?(n.style.transition="opacity 0.3s ease, transform 0.3s ease",n.style.opacity="0",n.style.transform="scale(0.95)",setTimeout(()=>{n.style.display="none",s.style.display="block"},300)):(n.style.display="none",s.style.display="block")}function V(){try{const e=localStorage.getItem(E);return e?JSON.parse(e):[]}catch{return[]}}function i(e){try{const t=V();t.includes(e)||(t.push(e),localStorage.setItem(E,JSON.stringify(t))),ie(e)}catch{}}function ae(e){try{const t=U();t.includes(e)||(t.push(e),localStorage.setItem(f,JSON.stringify(t)))}catch{}}function U(){try{const e=localStorage.getItem(f);return e?JSON.parse(e):[]}catch{return[]}}function ie(e){try{let t=U();t=t.filter(t=>t!==e),localStorage.setItem(f,JSON.stringify(t))}catch{}}function se(e){const t=e.id;if(window.Artalk||document.querySelector("#artalk, .artalk")){G(e);return}if(window.gitalk||document.querySelector("#gitalk-container")){te(e);return}if(window.Valine||window.Waline||document.querySelector("#valine, #waline")){he(e);return}if(window.twikoo||document.querySelector("#twikoo")){Q(e);return}Z(e)}function G(e){const r=e.id,n=()=>{const e=document.querySelector(".artalk .atk-comment-count, .artalk [data-comment-count]");return e?parseInt(e.textContent)||0:0};let c=n();const t=new MutationObserver(()=>{const s=n();s>c&&(a("è¯„è®ºæˆåŠŸï¼å†…å®¹å·²è§£é”"),setTimeout(()=>{o(e,!0),i(r)},1e3),t.disconnect())}),s=document.querySelector("#artalk, .artalk");s&&(t.observe(s,{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>t.disconnect(),3e4))}function te(e){const s=e.id,t=document.querySelector("#gitalk-container");if(!t)return;const n=new MutationObserver(()=>{const r=t.querySelectorAll(".gt-comment");r.length>0&&(a("è¯„è®ºæˆåŠŸï¼å†…å®¹å·²è§£é”"),setTimeout(()=>{o(e,!0),i(s)},1e3),n.disconnect())});n.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>n.disconnect(),3e4)}function he(e){const s=e.id,t=document.querySelector("#valine, #waline");if(!t)return;let r=t.querySelectorAll(".vcontent, .wl-content").length;const n=new MutationObserver(()=>{const c=t.querySelectorAll(".vcontent, .wl-content").length;c>r&&(a("è¯„è®ºæˆåŠŸï¼å†…å®¹å·²è§£é”"),setTimeout(()=>{o(e,!0),i(s)},1e3),n.disconnect())});n.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>n.disconnect(),3e4)}function Q(e){const s=e.id,t=document.querySelector("#twikoo");if(!t)return;let r=t.querySelectorAll(".tk-comment").length;const n=new MutationObserver(()=>{const c=t.querySelectorAll(".tk-comment").length;c>r&&(a("è¯„è®ºæˆåŠŸï¼å†…å®¹å·²è§£é”"),setTimeout(()=>{o(e,!0),i(s)},1e3),n.disconnect())});n.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>n.disconnect(),3e4)}function Z(e){const r=e.id,t=p();if(!t)return;const s=t.innerHTML,n=new MutationObserver(()=>{const c=t.innerHTML;c!==s&&c.length>s.length&&(a("æ£€æµ‹åˆ°è¯„è®ºå˜åŒ–ï¼å†…å®¹å·²è§£é”"),setTimeout(()=>{o(e,!0),i(r)},1e3),n.disconnect())});n.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>n.disconnect(),3e4)}function a(e){let t=document.querySelector(".reply-visible-notification");if(!t){t=document.createElement("div"),t.className="reply-visible-notification",document.body.appendChild(t);const e=document.createElement("style");e.textContent=`
      .reply-visible-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--accent);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        z-index: 10000;
        animation: slideInRight 0.3s ease;
        max-width: 300px;
      }
      
      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @media (max-width: 480px) {
        .reply-visible-notification {
          top: 10px;
          right: 10px;
          left: 10px;
          max-width: none;
        }
      }
    `,document.head.appendChild(e)}t.textContent=e,t.style.display="block",setTimeout(()=>{t.style.opacity="0",t.style.transform="translateX(100%)",setTimeout(()=>{t.style.display="none",t.style.opacity="1",t.style.transform="translateX(0)"},300)},3e3)}function ee(){const e=document.querySelectorAll(".reply-visible-button");e.forEach(e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)})}x=document.createElement("style"),x.textContent=`
  .highlight-comment {
    animation: highlightPulse 2s ease;
  }
  
  @keyframes highlightPulse {
    0%, 100% {
      box-shadow: 0 0 0 0 rgba(0, 102, 204, 0);
    }
    50% {
      box-shadow: 0 0 0 10px rgba(0, 102, 204, 0.2);
    }
  }
`,document.head.appendChild(x),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):O(),window.initReplyVisible=O,window.cleanupReplyVisible=ee,l=null;function v(){const e=document.querySelector(".footer-running-time");if(!e)return;const t=e.dataset.startDate;if(!t)return;const n=new Date(t);if(isNaN(n.getTime()))return;function s(){const o=new Date,t=o-n,i=Math.floor(t/(1e3*60*60*24)),a=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),r=Math.floor(t%(1e3*60*60)/(1e3*60)),c=Math.floor(t%(1e3*60)/1e3),s=e.querySelector(".running-time-value");s&&(s.innerHTML=`<span class="time-unit">${i}</span> å¤© <span class="time-unit">${a}</span> æ—¶ <span class="time-unit">${r}</span> åˆ† <span class="time-unit">${c}</span> ç§’`)}s(),l=setInterval(s,1e3)}function oe(){l&&(clearInterval(l),l=null)}window.initRunningTime=v,window.cleanupRunningTime=oe,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();function u(){if(typeof window.siteConfig=="undefined"){setTimeout(u,50);return}const e=window.siteConfig||{};e.pinnedIconColor&&document.documentElement.style.setProperty("--pinned-icon-color",e.pinnedIconColor),e.pinnedTextColor&&document.documentElement.style.setProperty("--pinned-text-color",e.pinnedTextColor),e.pinnedIconColorDark&&document.documentElement.style.setProperty("--pinned-icon-color-dark",e.pinnedIconColorDark),e.pinnedTextColorDark&&document.documentElement.style.setProperty("--pinned-text-color-dark",e.pinnedTextColorDark)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u(),window.initPinnedStyle=u,d=null,performance&&performance.timing?d=performance.timing.navigationStart:performance&&performance.now?d=Date.now()-performance.now():d=Date.now(),window.initDataPage=function(){const t=document.querySelector(".data-page");if(!t)return;const e=document.getElementById("umami-analytics");if(e){const t=e.dataset.apiUrl;t&&re(t)}le()};async function re(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const n=await t.json();ce(n)}catch(e){console.error("è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:",e);let t="è¯·ç¨åé‡è¯•";e.message.includes("Failed to fetch")||e.message.includes("CORS")?t="APIæœåŠ¡å™¨éœ€è¦é…ç½®CORSè·¨åŸŸè®¿é—®æƒé™":e.message.includes("HTTP")&&(t=e.message),ve(t)}}function ce(e){const t={today_uv:document.querySelector('[data-stat="today_uv"] .loading-skeleton'),today_pv:document.querySelector('[data-stat="today_pv"] .loading-skeleton'),yesterday_uv:document.querySelector('[data-stat="yesterday_uv"] .loading-skeleton'),yesterday_pv:document.querySelector('[data-stat="yesterday_pv"] .loading-skeleton'),last_month_pv:document.querySelector('[data-stat="last_month_pv"] .loading-skeleton'),last_year_pv:document.querySelector('[data-stat="last_year_pv"] .loading-skeleton')};Object.keys(t).forEach((n,s)=>{const o=t[n];o&&e[n]!==0[0]&&setTimeout(()=>{o.classList.remove("loading-skeleton"),H(o,0,e[n],1e3)},s*100)})}function le(){const e=document.querySelector("#stat-total-words .stat-value");if(e){const t=e.dataset.words;if(t){const n=parseInt(t,10);e.classList.remove("loading-skeleton"),e.textContent=$(n)}else de().then(t=>{e.classList.remove("loading-skeleton"),e.textContent=$(t)}).catch(()=>{e.classList.remove("loading-skeleton"),e.textContent="--"})}const s=document.querySelector("#stat-response-time .stat-value");if(s){const e=X();s.classList.remove("loading-skeleton"),s.textContent=e}const t=document.querySelector("#stat-last-update .stat-value");t&&me().then(e=>{t.classList.remove("loading-skeleton"),t.textContent=e}).catch(()=>{t.classList.remove("loading-skeleton"),t.textContent="--"});const n=document.querySelector("#stat-comment-count .stat-value");n&&fe().then(e=>{n.classList.remove("loading-skeleton"),H(n,0,e,1e3)}).catch(()=>{n.classList.remove("loading-skeleton"),n.textContent="--"})}async function de(){try{const t=await fetch("/index.json");if(!t.ok)throw new Error("æ— æ³•è·å–æ–‡ç« æ•°æ®");const e=await t.json();let n=0;const s=Array.isArray(e)?e:e.posts||[];return Array.isArray(s)&&s.forEach(e=>{if(e.description){const t=e.description.replace(/<[^>]+>/g,"").replace(/\n+/g," ").trim(),s=t.length*50;n+=s}}),n}catch(e){throw console.error("è®¡ç®—å…¨ç«™å­—æ•°å¤±è´¥:",e),e}}function $(e){return e>=1e4?(e/1e4).toFixed(2)+" ä¸‡":e>=1e3?(e/1e3).toFixed(2)+" åƒ":e.toString()}function X(){if(performance&&performance.timing){const e=performance.timing;if(e.loadEventEnd>0){const t=e.loadEventEnd-e.navigationStart;return t<1e3?t.toFixed(0)+" ms":(t/1e3).toFixed(2)+" s"}else{const e=Date.now()-d;return e<1e3?e.toFixed(0)+" ms":(e/1e3).toFixed(2)+" s"}}else if(performance&&performance.now){const e=performance.now();return e<1e3?e.toFixed(0)+" ms":(e/1e3).toFixed(2)+" s"}return"--"}async function me(){try{const n=await fetch("/index.json");if(!n.ok)throw new Error("æ— æ³•è·å–æ–‡ç« æ•°æ®");const t=await n.json();let e=null;const s=Array.isArray(t)?t:t.posts||[];if(Array.isArray(s)&&s.forEach(t=>{if(t.lastmod){const n=new Date(t.lastmod);(!e||n>e)&&(e=n)}else if(t.date){const n=new Date(t.date);(!e||n>e)&&(e=n)}}),e){const n=new Date,s=n-e,t=Math.floor(s/(1e3*60*60*24));return t===0?"ä»Šå¤©":t===1?"æ˜¨å¤©":t<7?t+" å¤©å‰":t<30?Math.floor(t/7)+" å‘¨å‰":t<365?Math.floor(t/30)+" ä¸ªæœˆå‰":Math.floor(t/365)+" å¹´å‰"}return"--"}catch(e){throw console.error("è·å–æœ€åæ›´æ–°æ—¶é—´å¤±è´¥:",e),e}}async function fe(){try{const e=window.artalkConfig||{};if(!e.server)throw new Error("æœªé…ç½®ArtalkæœåŠ¡å™¨");const s=`${e.server}/api/v2/stats/latest_comments?site_name=${encodeURIComponent(e.site||"default")}&limit=1000`,t=await fetch(s);if(!t.ok)throw new Error(`HTTP ${t.status}`);const n=await t.json();return n.data&&Array.isArray(n.data)?n.data.length:0}catch(e){return console.error("è·å–è¯„è®ºæ•°ç›®å¤±è´¥:",e),0}}function H(e,t,n,s){const i=performance.now(),a=n-t;function o(r){const l=r-i,c=Math.min(l/s,1),d=1-(1-c)**3,u=Math.floor(t+a*d);e.textContent=P(u),c<1?requestAnimationFrame(o):e.textContent=P(n)}requestAnimationFrame(o)}function P(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function ve(e){const t=document.getElementById("analytics-error"),n=document.getElementById("umami-analytics"),s=t?.querySelector(".error-detail");t&&n&&(n.style.display="none",t.style.display="block",s&&e&&(s.textContent=e))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",window.initDataPage):window.initDataPage(),document.addEventListener("pjax:complete",function(){setTimeout(window.initDataPage,100)});function h(){m(),ye(),we()}function m(){const e=document.querySelector(".full-encryption-overlay");e&&e.remove()}function ye(){const e=document.querySelectorAll(".encrypted-content");e.forEach(e=>{const i=e.querySelector(".encryption-submit"),n=e.querySelector(".encryption-password"),a=e.querySelector(".encryption-error"),s=e.querySelector(".encryption-box"),o=e.querySelector(".encrypted-data"),t=e.querySelector(".encrypted-data-source"),r=e.dataset.password;if(t&&t.innerHTML.trim())try{const n=t.innerHTML,s=btoa(unescape(encodeURIComponent(n)));e.dataset.encryptedContent=s,t.innerHTML="",t.remove()}catch(e){console.error("[Encryption] éƒ¨åˆ†åŠ å¯†å†…å®¹ç¼–ç å¤±è´¥:",e)}const c=Array.from(e.parentElement.children).indexOf(e),l=sessionStorage.getItem(`encrypted_${c}`);if(l==="unlocked"&&e.dataset.encryptedContent)try{const t=decodeURIComponent(escape(atob(e.dataset.encryptedContent)));o.innerHTML=t,s.style.display="none",o.style.display="block"}catch(e){console.error("[Encryption] è§£ç å†…å®¹å¤±è´¥:",e)}Ce(s),i&&i.addEventListener("click",()=>{T(n,r,a,s,o,e)}),n&&n.addEventListener("keypress",t=>{t.key==="Enter"&&T(n,r,a,s,o,e)})})}async function T(e,t,n,s,o,i){const a=e.value.trim();if(!a){c(n,"è¯·è¾“å…¥å¯†ç ");return}const r=await K(a);if(r===t){const e=i.dataset.encryptedContent;if(e)try{const t=decodeURIComponent(escape(atob(e)));o.innerHTML=t,s.style.display="none",o.style.display="block";const n=Array.from(i.parentElement.children).indexOf(i);sessionStorage.setItem(`encrypted_${n}`,"unlocked")}catch(e){console.error("[Encryption] è§£ç å†…å®¹å¤±è´¥:",e),c(n,"å†…å®¹è§£ç å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•")}else{s.style.display="none",o.style.display="block";const e=Array.from(i.parentElement.children).indexOf(i);sessionStorage.setItem(`encrypted_${e}`,"unlocked")}}else{const t=window.siteConfig?.encryption?.wrongPasswordHint||"å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•";c(n,t),e.value="",e.focus()}}function we(){const t=document.querySelector("article.post");if(!t)return;const o=t.dataset.password;if(!o)return;const i=t.dataset.slug||window.location.pathname,c=sessionStorage.getItem(`full_encrypted_${i}`),s=t.querySelector(".post-content");if(s){const e=s.innerHTML;if(e&&e.trim()&&!t.dataset.encryptedContent)try{const n=btoa(unescape(encodeURIComponent(e)));t.dataset.encryptedContent=n,s.innerHTML=""}catch(e){console.error("[Encryption] å…¨æ–‡åŠ å¯†å†…å®¹ç¼–ç å¤±è´¥:",e)}if(c==="unlocked"&&t.dataset.encryptedContent){try{const e=decodeURIComponent(escape(atob(t.dataset.encryptedContent)));s.innerHTML=e,s.style.display="block"}catch(e){console.error("[Encryption] è§£ç å†…å®¹å¤±è´¥:",e)}return}s.style.display="none"}t.style.position="relative";const l=t.dataset.hint||window.siteConfig?.encryption?.fullHint||"æ­¤æ–‡ç« å·²åŠ å¯†ï¼Œè¯·è¾“å…¥å¯†ç æŸ¥çœ‹å®Œæ•´å†…å®¹",n=document.createElement("div");n.className="full-encryption-overlay",n.innerHTML=`
        <div class="full-encryption-container">
            <div class="encryption-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
            </div>
            <h2>ğŸ”’ æ–‡ç« å·²åŠ å¯†</h2>
            <p class="encryption-hint">${l}</p>
            <div class="encryption-input-group">
                <input type="password" class="encryption-password" placeholder="è¯·è¾“å…¥å¯†ç " autofocus>
                <button class="encryption-submit">è§£é”</button>
            </div>
            <p class="encryption-error" style="display:none;"></p>
        </div>
    `,xe(n),t.appendChild(n);const e=n.querySelector(".full-encryption-container");if(e){const i=e.offsetHeight,a=e.offsetWidth;e.style.visibility="hidden",e.style.opacity="0",e.style.animation="none",e.style.removeProperty("transform"),e.style.pointerEvents="none",e.style.willChange="transform, opacity";let r=0,s=i,o=a,n=e.scrollHeight;const t=()=>{const i=e.offsetHeight,a=e.offsetWidth,t=e.scrollHeight,c=window.getComputedStyle(e),u=c.transform,h=c.backgroundImage,l=Math.abs(i-s),d=Math.abs(a-o);l>1||d>1?(r++,s=i,o=a,n=t):t!==n&&(n=t)};void e.offsetHeight,void e.offsetWidth,void e.scrollHeight,t(),requestAnimationFrame(()=>{void e.offsetHeight,t(),requestAnimationFrame(()=>{void e.offsetHeight,t();const s=window.siteConfig?.encryption?.popupBackgroundImage&&typeof window.siteConfig.encryption.popupBackgroundImage=="string"&&window.siteConfig.encryption.popupBackgroundImage.trim()||"",n=()=>{void e.offsetHeight,void e.offsetWidth,void e.scrollHeight,t(),requestAnimationFrame(()=>{void e.offsetHeight,t(),requestAnimationFrame(()=>{void e.offsetHeight,t(),void e.offsetHeight,void e.offsetWidth,t();const n={height:e.offsetHeight,width:e.offsetWidth,scrollHeight:e.scrollHeight,computedStyle:{transform:window.getComputedStyle(e).transform,animation:window.getComputedStyle(e).animation,visibility:window.getComputedStyle(e).visibility,opacity:window.getComputedStyle(e).opacity}};e.style.removeProperty("transform"),e.style.visibility="visible",e.style.pointerEvents="auto",void e.offsetHeight,void e.offsetWidth,void e.scrollHeight,t(),requestAnimationFrame(()=>{void e.offsetHeight,void e.offsetWidth,t(),requestAnimationFrame(()=>{void e.offsetHeight,void e.offsetWidth,t(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.opacity="0",e.style.animation="fadeIn 0.3s cubic-bezier(0.25, 0.1, 0.25, 1) forwards"})}),void e.offsetHeight,void e.offsetWidth,t();const n={height:e.offsetHeight,width:e.offsetWidth,scrollHeight:e.scrollHeight,computedStyle:{transform:window.getComputedStyle(e).transform,animation:window.getComputedStyle(e).animation,visibility:window.getComputedStyle(e).visibility,opacity:window.getComputedStyle(e).opacity}}})})})})};requestAnimationFrame(s?()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{void e.offsetHeight,void e.offsetWidth,n()})})}:()=>{n()})})})}const d=n.querySelector(".encryption-submit"),a=n.querySelector(".encryption-password"),r=n.querySelector(".encryption-error");d.addEventListener("click",()=>{R(a,o,r,n,s,i)}),a.addEventListener("keypress",e=>{e.key==="Enter"&&R(a,o,r,n,s,i)})}async function R(e,t,n,s,o,i){const a=e.value.trim();if(!a){c(n,"è¯·è¾“å…¥å¯†ç ");return}const r=await K(a);if(r===t){const t=o?.closest("article.post"),e=t?.dataset.encryptedContent;if(e&&o)try{const t=decodeURIComponent(escape(atob(e)));o.innerHTML=t}catch(e){console.error("[Encryption] è§£ç å†…å®¹å¤±è´¥:",e),c(n,"å†…å®¹è§£ç å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");return}s.style.animation="fadeOut 0.3s ease-out",setTimeout(()=>{s.remove(),o&&(o.style.display="block",o.style.animation="fadeIn 0.5s ease-in-out")},300),sessionStorage.setItem(`full_encrypted_${i}`,"unlocked")}else{const t=window.siteConfig?.encryption?.wrongPasswordHint||"å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•";c(n,t),e.value="",e.focus()}}function xe(e){const t=e.querySelector(".full-encryption-container");if(!t)return;if(!window.siteConfig){console.error("[Encryption] window.siteConfig ä¸å­˜åœ¨ï¼");return}if(!window.siteConfig.encryption){console.error("[Encryption] window.siteConfig.encryption ä¸å­˜åœ¨ï¼");return}const n=window.siteConfig.encryption;let o="#ffffff";n.popupTextColor&&typeof n.popupTextColor=="string"&&n.popupTextColor.trim()&&(o=n.popupTextColor.trim());const r=t.querySelectorAll(".encryption-icon, .encryption-icon svg"),c=t.querySelectorAll("h2, .encryption-hint");r.forEach(e=>{e.style.setProperty("color",o,"important")}),c.forEach(e=>{e.style.setProperty("color",o,"important")});const l=t.querySelectorAll(".encryption-error");l.forEach(e=>{e.style.setProperty("color",o,"important"),e.style.opacity="0.9"});let s="";n.popupBackgroundColor&&typeof n.popupBackgroundColor=="string"&&n.popupBackgroundColor.trim()&&(s=n.popupBackgroundColor.trim());const a="linear-gradient(135deg, #667eea 0%, #764ba2 100%)";let i="";if(n.popupBackgroundImage&&typeof n.popupBackgroundImage=="string"&&n.popupBackgroundImage.trim()&&(i=n.popupBackgroundImage.trim()),t.style.removeProperty("background"),t.style.removeProperty("background-color"),t.style.removeProperty("background-image"),t.style.removeProperty("background-size"),t.style.removeProperty("background-position"),t.style.removeProperty("background-repeat"),i){const e=s||a;e.includes("gradient")?t.style.setProperty("background",e,"important"):t.style.setProperty("background-color",e,"important");const n=new Image;n.onload=()=>{t.style.setProperty("background-image",`url("${i}")`,"important"),t.style.setProperty("background-size","cover","important"),t.style.setProperty("background-position","center","important"),t.style.setProperty("background-repeat","no-repeat","important"),s&&!s.includes("gradient")&&t.style.setProperty("background-color",s,"important"),void t.offsetHeight,void t.offsetWidth},n.onerror=()=>{},n.src=i}else{const e=s||a;e.includes("gradient")?t.style.setProperty("background",e,"important"):t.style.setProperty("background-color",e,"important")}}function Ce(e){if(!e)return;if(!window.siteConfig){console.error("[Encryption] window.siteConfig ä¸å­˜åœ¨ï¼");return}if(!window.siteConfig.encryption){console.error("[Encryption] window.siteConfig.encryption ä¸å­˜åœ¨ï¼");return}const n=window.siteConfig.encryption;if(n.partialPopupTextColor&&typeof n.partialPopupTextColor=="string"&&n.partialPopupTextColor.trim()){const t=n.partialPopupTextColor.trim(),s=e.querySelectorAll(".encryption-icon, .encryption-icon svg"),o=e.querySelectorAll(".encryption-hint");s.forEach(e=>{e.style.setProperty("color",t,"important")}),o.forEach(e=>{e.style.setProperty("color",t,"important")});const i=e.querySelectorAll(".encryption-error");i.forEach(e=>{e.style.setProperty("color",t,"important"),e.style.opacity="0.9"})}let t="";n.partialPopupBackgroundColor&&typeof n.partialPopupBackgroundColor=="string"&&n.partialPopupBackgroundColor.trim()&&(t=n.partialPopupBackgroundColor.trim());let s="";if(n.partialPopupBackgroundImage&&typeof n.partialPopupBackgroundImage=="string"&&n.partialPopupBackgroundImage.trim()&&(s=n.partialPopupBackgroundImage.trim()),e.style.removeProperty("background"),e.style.removeProperty("background-color"),e.style.removeProperty("background-image"),e.style.removeProperty("background-size"),e.style.removeProperty("background-position"),e.style.removeProperty("background-repeat"),s){t&&(t.includes("gradient")?e.style.setProperty("background",t,"important"):e.style.setProperty("background-color",t,"important"));const n=new Image;n.onload=()=>{e.style.setProperty("background-image",`url("${s}")`,"important"),e.style.setProperty("background-size","cover","important"),e.style.setProperty("background-position","center","important"),e.style.setProperty("background-repeat","no-repeat","important"),t&&!t.includes("gradient")&&e.style.setProperty("background-color",t,"important")},n.onerror=()=>{t&&(t.includes("gradient")?e.style.setProperty("background",t,"important"):e.style.setProperty("background-color",t,"important"))},n.src=s}else if(t&&(t.includes("gradient")?e.style.setProperty("background",t,"important"):e.style.setProperty("background-color",t,"important"),t&&(!n.partialPopupTextColor||!n.partialPopupTextColor.trim()))){const n=t.includes("#")&&(t.includes("000")||t.includes("111")||t.includes("222")||t.includes("333"))||t.includes("rgb(0")||t.includes("rgba(0");if(n){const t=e.querySelectorAll(".encryption-icon, .encryption-icon svg"),n=e.querySelectorAll(".encryption-hint");t.forEach(e=>{e.style.setProperty("color","#ffffff","important")}),n.forEach(e=>{e.style.setProperty("color","#ffffff","important")})}}}function c(e,t){if(!e)return;e.textContent=t,e.style.display="block",setTimeout(()=>{e.style.display="none"},3e3)}async function K(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),s=Array.from(new Uint8Array(n)),o=s.map(e=>e.toString(16).padStart(2,"0")).join("");return o}if(q=`
@keyframes fadeOut {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}
`,!document.querySelector("#encryption-animations")){const e=document.createElement("style");e.id="encryption-animations",e.textContent=q,document.head.appendChild(e)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{h()}):h(),window.addEventListener("popstate",()=>{m()}),document.addEventListener("pjax:send",()=>{m()}),document.addEventListener("pjax:complete",()=>{setTimeout(()=>{h()},100)}),window.initEncryption=h,window.cleanupEncryptionOverlay=m,function(){"use strict";function e(){if(!document.querySelector(".life-time-card"))return;function e(){const f=+new Date,h=new Date;h.setHours(0,0,0,0);const v=h.getTime(),c=(f-v)/1e3/60/60,r=c/24*100,e=document.getElementById("dayProgress");if(e){const t=e.querySelector(".title span"),n=e.querySelector(".progress-inner"),s=e.querySelector(".progress-percentage");t&&(t.textContent=Math.floor(c)),n&&(n.style.width=Math.floor(r)+"%"),s&&(s.textContent=Math.floor(r)+"%")}const m={0:7,1:1,2:2,3:3,4:4,5:5,6:6},a=m[(new Date).getDay()],i=a/7*100,s=document.getElementById("weekProgress");if(s){const e=s.querySelector(".title span"),t=s.querySelector(".progress-inner"),n=s.querySelector(".progress-percentage");e&&(e.textContent=a),t&&(t.style.width=Math.floor(i)+"%"),n&&(n.textContent=Math.floor(i)+"%")}const p=(new Date).getFullYear(),o=(new Date).getMonth()+1,l=(new Date).getDate(),g=new Date(p,o,0).getDate(),d=l/g*100,n=document.getElementById("monthProgress");if(n){const e=n.querySelector(".title span"),t=n.querySelector(".progress-inner"),s=n.querySelector(".progress-percentage");e&&(e.textContent=l),t&&(t.style.width=Math.floor(d)+"%"),s&&(s.textContent=Math.floor(d)+"%")}const u=o/12*100,t=document.getElementById("yearProgress");if(t){const e=t.querySelector(".title span"),n=t.querySelector(".progress-inner"),s=t.querySelector(".progress-percentage");e&&(e.textContent=o),n&&(n.style.width=Math.floor(u)+"%"),s&&(s.textContent=Math.floor(u)+"%")}}e(),setInterval(()=>{e()},1e3)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),document.addEventListener("pjax:complete",function(){setTimeout(e,100)})}(),function(){"use strict";let e=null;performance&&performance.timing?e=performance.timing.navigationStart:performance&&performance.now?e=Date.now()-performance.now():e=Date.now();function t(){const d=document.querySelector(".data-stats-card");if(!d)return;const e=document.querySelector("#sidebar-stat-total-words .data-stats-value");if(e){const t=e.dataset.words;if(t){const s=parseInt(t,10);e.classList.remove("loading-skeleton"),e.textContent=n(s)}else s().then(t=>{e.classList.remove("loading-skeleton"),e.textContent=n(t)}).catch(()=>{e.classList.remove("loading-skeleton"),e.textContent="--"})}const l=document.querySelector("#sidebar-stat-response-time .data-stats-value");if(l){const e=o();l.classList.remove("loading-skeleton"),l.textContent=e}const t=document.querySelector("#sidebar-stat-last-update .data-stats-value");t&&i().then(e=>{t.classList.remove("loading-skeleton"),t.textContent=e}).catch(()=>{t.classList.remove("loading-skeleton"),t.textContent="--"});const c=document.querySelector("#sidebar-stat-comment-count .data-stats-value");c&&a().then(e=>{c.classList.remove("loading-skeleton"),c.textContent=r(e)}).catch(()=>{c.classList.remove("loading-skeleton"),c.textContent="--"})}async function s(){try{const t=await fetch("/index.json");if(!t.ok)throw new Error("æ— æ³•è·å–æ–‡ç« æ•°æ®");const e=await t.json();let n=0;const s=Array.isArray(e)?e:e.posts||[];return Array.isArray(s)&&s.forEach(e=>{if(e.description){const t=e.description.replace(/<[^>]+>/g,"").replace(/\n+/g," ").trim(),s=t.length*50;n+=s}}),n}catch(e){throw console.error("è®¡ç®—å…¨ç«™å­—æ•°å¤±è´¥:",e),e}}function n(e){return e>=1e4?(e/1e4).toFixed(2)+" ä¸‡":e>=1e3?(e/1e3).toFixed(2)+" åƒ":e.toString()}function o(){if(performance&&performance.timing){const t=performance.timing;if(t.loadEventEnd>0){const e=t.loadEventEnd-t.navigationStart;return e<1e3?e.toFixed(0)+" ms":(e/1e3).toFixed(2)+" s"}else{const t=Date.now()-e;return t<1e3?t.toFixed(0)+" ms":(t/1e3).toFixed(2)+" s"}}else if(performance&&performance.now){const e=performance.now();return e<1e3?e.toFixed(0)+" ms":(e/1e3).toFixed(2)+" s"}return"--"}async function i(){try{const n=await fetch("/index.json");if(!n.ok)throw new Error("æ— æ³•è·å–æ–‡ç« æ•°æ®");const t=await n.json();let e=null;const s=Array.isArray(t)?t:t.posts||[];if(Array.isArray(s)&&s.forEach(t=>{if(t.lastmod){const n=new Date(t.lastmod);(!e||n>e)&&(e=n)}else if(t.date){const n=new Date(t.date);(!e||n>e)&&(e=n)}}),e){const n=new Date,s=n-e,t=Math.floor(s/(1e3*60*60*24));return t===0?"ä»Šå¤©":t===1?"æ˜¨å¤©":t<7?t+" å¤©å‰":t<30?Math.floor(t/7)+" å‘¨å‰":t<365?Math.floor(t/30)+" ä¸ªæœˆå‰":Math.floor(t/365)+" å¹´å‰"}return"--"}catch(e){throw console.error("è·å–æœ€åæ›´æ–°æ—¶é—´å¤±è´¥:",e),e}}async function a(){try{const e=window.artalkConfig||{};if(!e.server)throw new Error("æœªé…ç½®ArtalkæœåŠ¡å™¨");const s=`${e.server}/api/v2/stats/latest_comments?site_name=${encodeURIComponent(e.site||"default")}&limit=1000`,t=await fetch(s);if(!t.ok)throw new Error(`HTTP ${t.status}`);const n=await t.json();return n.data&&Array.isArray(n.data)?n.data.length:0}catch(e){return console.error("è·å–è¯„è®ºæ•°ç›®å¤±è´¥:",e),0}}function r(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t(),document.addEventListener("pjax:complete",function(){setTimeout(t,100)})}(),function(){"use strict";let n=null,s=!1;function e(){const c=document.querySelector(".hitokoto-card");if(!c)return;const e=window.hitokotoConfig||{};if(!e.enabled)return;const t=document.getElementById("hitokoto-sentence"),s=document.getElementById("hitokoto-from");if(!t)return;const r=e.apiType||"nsmao";n=r,r==="nsmao"&&e.nsmao&&e.nsmao.apiKey?i(e.nsmao,t,s,e.showFrom).catch(()=>{a(t,s,e.showFrom)}):o(t,s,e.showFrom)}async function i(e,n,s,o){try{const l=e.apiUrl||"https://api.nsmao.net/api/history/query",d=`${l}?key=${encodeURIComponent(e.apiKey)}`,a=await fetch(d,{method:"GET"});if(!a.ok){const e=await a.text();throw console.error("APIé”™è¯¯å“åº”:",e),new Error(`HTTP ${a.status}: ${a.statusText}`)}const i=await a.json();if(i.code&&i.code!==200)throw new Error(i.msg||i.message||"APIè¿”å›é”™è¯¯");let r=null,c=null;if(i.data&&typeof i.data=="object"){const e=Object.entries(i.data);if(e.length>0){const t=Math.floor(Math.random()*e.length),[n,s]=e[t];r=s,c=n}}if(r)n.innerHTML=t(r),o&&s&&c?(s.textContent=c,s.style.display="block"):s&&(s.style.display="none");else throw console.error("APIè¿”å›æ•°æ®:",i),new Error("APIè¿”å›æ ¼å¼ä¸æ­£ç¡®ï¼Œæœªæ‰¾åˆ°å†…å®¹å­—æ®µ")}catch(e){throw console.error("è·å–é’æ¡”APIä¸€è¨€å¤±è´¥:",e),e}}function o(e,n,o){if(s){window.jinrishici&&window.jinrishici.load&&window.jinrishici.load(function(s){s&&s.data&&(e.innerHTML=t(s.data.content),o&&n&&s.data.origin?(n.textContent=s.data.origin.title||s.data.origin.dynasty+"\xB7"+s.data.origin.author,n.style.display="block"):n&&(n.style.display="none"))});return}const i=document.createElement("script");i.src="https://sdk.jinrishici.com/v2/browser/jinrishici.js",i.charset="utf-8",i.onload=function(){s=!0,window.jinrishici&&window.jinrishici.load&&window.jinrishici.load(function(s){s&&s.data&&(e.innerHTML=t(s.data.content),o&&n&&s.data.origin?(n.textContent=s.data.origin.title||s.data.origin.dynasty+"\xB7"+s.data.origin.author,n.style.display="block"):n&&(n.style.display="none"))})},i.onerror=function(){e.innerHTML='<span class="hitokoto-error">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</span>'},document.head.appendChild(i)}function a(e,t,s){if(n==="jinrishici")return;o(e,t,s)}function t(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),document.addEventListener("pjax:complete",function(){setTimeout(e,100)})}(),function(){"use strict";function n(){const e=(new Date).getHours();return e<6?{greeting:"ğŸŒ› æ·±å¤œå¥½å‘€ ğŸ‘‹",advice:"ğŸŒ™ä¸è¦ç†¬å¤œ æ—©ç‚¹ä¼‘æ¯å•¦ğŸŒ™"}:e<11?{greeting:"ğŸŒ æ—©ä¸Šå¥½å‘€ ğŸ‘‹",advice:"ğŸ’ªæ–°çš„ä¸€å¤© å……æ»¡æ´»åŠ›ğŸ’ª"}:e<13?{greeting:"ğŸ½ï¸ ä¸­åˆå¥½å‘€ ğŸ‘‹",advice:"ğŸ”åˆ«å¿˜äº†äº«å—ä¸€é¡¿ç¾å‘³çš„åˆé¤ğŸ”"}:e<18?{greeting:"â˜• ä¸‹åˆå¥½å‘€ ğŸ‘‹",advice:"ğŸµä¼‘æ¯ä¸€ä¸‹ å–æ¯å’–å•¡å§ğŸµ"}:e<22?{greeting:"ğŸŒœ æ™šä¸Šå¥½å‘€ ğŸ‘‹",advice:"ğŸŒƒæ”¾æ¾å¿ƒæƒ… äº«å—å¤œæ™šçš„å®é™ğŸŒƒ"}:{greeting:"ğŸŒ› æ·±å¤œå¥½å‘€ ğŸ‘‹",advice:"ğŸŒ™ä¸è¦ç†¬å¤œ æ—©ç‚¹ä¼‘æ¯å•¦ğŸŒ™"}}function e(e){return e*(Math.PI/180)}function s(t,n,s,o){const a=6371,r=e(t-s),c=e(n-o),i=Math.sin(r/2)**2+Math.cos(e(s))*Math.cos(e(t))*Math.sin(c/2)**2,l=2*Math.atan2(i**.5,(1-i)**.5);return(a*l).toFixed(2)}async function o(e){if(!e)return console.error("è®¿å®¢ä¿¡æ¯APIå¯†é’¥æœªé…ç½®"),null;const t=[{url:`https://api.nsmao.net/api/ip/query?key=${encodeURIComponent(e)}`,provinceField:"prov"},{url:`https://api.nsmao.net/api/ipip/query?key=${encodeURIComponent(e)}`,provinceField:"province"}];for(const e of t)try{const n=await fetch(e.url),t=await n.json();if(t.code===200&&t.data){const n=t.data;return{ip:n.ip,country:n.country,province:n[e.provinceField],city:n.city,district:n.district,adcode:n.adcode,lat:n.lat,lng:n.lng}}}catch(t){console.error(`è·å–åœ°ç†ä½ç½®å¤±è´¥ (${e.url})ï¼š`,t);continue}return null}function i(e,t){const{greeting:a,advice:r}=n();let o="";e.province&&(o+=`<strong style="color: ${t.fontColor};">${e.province} </strong>`),e.city&&(o+=`<strong style="color: ${t.fontColor};">${e.city} </strong>`),e.district&&(o+=`<strong style="color: ${t.fontColor};">${e.district}</strong>`);const c=s(e.lat,e.lng,t.customLat,t.customLng),i=document.getElementById("visitorInfoMessage");i&&(i.innerHTML=`<p><strong>${a}</strong></p><p>æ¬¢è¿æ¥è‡ª ${o} çš„å°ä¼™ä¼´ï¼</p><p>${r}</p><p>ğŸŒ æ‚¨å½“å‰çš„ IP æ˜¯<strong><span class="visitor-ip-mask" style="color: ${t.fontColor};">${e.ip}</span></strong> ğŸŒ</p><p>ğŸ“ è·ç¦» <strong style="color: ${t.fontColor};">${t.siteName}</strong> çº¦<strong style="color: ${t.fontColor};">${c}</strong> å…¬é‡Œå“¦ï¼ğŸ“</p>`)}async function t(){const n=document.querySelector(".visitor-info-card");if(!n)return;const e=window.visitorInfoConfig||{};if(!e.enabled)return;if(!e.apiKey){const e=document.getElementById("visitorInfoMessage");e&&(e.innerHTML="<p>ğŸŒ è®¿å®¢ä¿¡æ¯ç»„ä»¶æœªé…ç½®APIå¯†é’¥ ğŸŒ</p>");return}const t=await o(e.apiKey);if(t&&t.lat&&t.lng)i(t,e);else{const e=document.getElementById("visitorInfoMessage");e&&(e.innerHTML="<p>ğŸŒ è¿™ä½å°ä¼™ä¼´ï¼Œä½ ä¼¼ä¹è¿·å¤±äº†~ğŸŒ</p><p>è·å–ä½ç½®ä¿¡æ¯å¤±è´¥ï¼Œè¯·ç¨åå†è¯•~ğŸ˜…</p>")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t(),document.addEventListener("pjax:complete",function(){setTimeout(t,100)})}(),function(){"use strict";function e(){const a=window.randomImageConfig||{};if(!a.enabled)return;const d=document.querySelector(".random-image-card");if(!d)return;let t=a.apis;if(typeof t=="string")try{const e=JSON.parse(t);t=e}catch{t=t.trim()!==""?[t.trim()]:[]}let n=[];if(t&&(Array.isArray(t)?n=t.filter(e=>{if(typeof e!="string"||e.trim()==="")return!1;if(e.trim().startsWith("[")||e.trim().startsWith('"'))try{const t=JSON.parse(e);if(Array.isArray(t))return t.forEach(e=>{typeof e=="string"&&e.trim()!==""&&n.push(e.trim())}),!1}catch{}return!0}).map(e=>e.trim()):typeof t=="string"&&t.trim()!==""&&(n=[t.trim()])),n.length===0){i("æœªé…ç½®API");return}const r=document.getElementById("random-image-container"),e=document.getElementById("random-image"),s=r?r.querySelector(".random-image-loading"):null,o=document.getElementById("random-image-error"),l=document.getElementById("random-image-refresh");function i(t){if(s&&(s.style.display="none"),e&&(e.style.display="none"),o){o.style.display="flex";const e=o.querySelector("span");e&&(e.textContent=t)}}function c(){if(!r||!e)return;const t=n[Math.floor(Math.random()*n.length)];if(!t){i("APIé…ç½®æ— æ•ˆ");return}s&&(s.style.display="flex"),e&&(e.style.display="none"),o&&(o.style.display="none");const a=new Image,d=t.includes("?")?`${t}&t=${Date.now()}`:`${t}?t=${Date.now()}`;let l,c=!1;a.onload=function(){if(c)return;c=!0,clearTimeout(l),s&&(s.style.display="none"),o&&(o.style.display="none"),e&&(e.src=a.src,e.style.display="block",e.style.opacity="0",setTimeout(()=>{e.style.transition="opacity 0.3s ease",e.style.opacity="1"},10))},a.onerror=function(){if(c)return;if(clearTimeout(l),s&&(s.style.display="none"),e&&(e.style.display="none"),n.length>1){const r=n.indexOf(t),c=(r+1)%n.length,a=n[c];a&&a!==t?setTimeout(()=>{const t=new Image,r=a.includes("?")?`${a}&t=${Date.now()}`:`${a}?t=${Date.now()}`;let n=!1;t.onload=function(){if(n)return;n=!0,s&&(s.style.display="none"),o&&(o.style.display="none"),e&&(e.src=t.src,e.style.display="block",e.style.opacity="0",setTimeout(()=>{e.style.transition="opacity 0.3s ease",e.style.opacity="1"},10))},t.onerror=function(){if(n)return;i("æ‰€æœ‰APIåŠ è½½å¤±è´¥")},t.src=r},500):i("åŠ è½½å¤±è´¥")}else i("åŠ è½½å¤±è´¥")},l=setTimeout(()=>{c||(a.onerror=null,a.onload=null,i("åŠ è½½è¶…æ—¶"))},1e4),a.src=d}l&&l.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),c()}),c(),a.refreshInterval&&a.refreshInterval>0&&setInterval(c,a.refreshInterval*1e3)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),typeof window!="undefined"&&document.addEventListener("pjax:complete",function(){setTimeout(e,100)})}(),function(){"use strict";function e(){if(typeof window.Meting!="undefined"){const e=document.querySelectorAll("meting-js:not([data-loaded])");e.length>0&&e.forEach(e=>{e.setAttribute("data-loaded","true")})}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),document.addEventListener("pjax:complete",function(){setTimeout(e,100)})}(),function(){"use strict";let t=!1,a=0,i=0,s=0,o=0;function e(){if(!window.musicFloatPlayerConfig||!window.musicFloatPlayerConfig.enabled)return;const e=document.getElementById("music-player-float");if(!e)return;if(e.dataset.initialized==="true")return;e.dataset.initialized="true";const t=()=>{typeof APlayer!="undefined"&&typeof MetingJSElement!="undefined"?(e.style.display="block",n(e)):setTimeout(t,100)};setTimeout(t,200),typeof APlayer!="undefined"&&(e.style.display="block",n(e))}function n(e){f(e);const t=e.querySelector(".music-player-float-drag-handle");t&&l(e,t);const n=e.querySelector(".minimize-btn");n&&n.addEventListener("click",function(t){t.stopPropagation(),d(e)});const s=e.querySelector(".close-btn");s&&s.addEventListener("click",function(t){t.stopPropagation(),u(e)})}function l(e,n){n.addEventListener("mousedown",function(n){n.preventDefault(),n.stopPropagation(),t=!0,e.classList.add("dragging");const l=e.getBoundingClientRect();a=n.clientX,i=n.clientY,s=l.left,o=l.top,document.addEventListener("mousemove",r),document.addEventListener("mouseup",c)})}function r(e){if(!t)return;e.preventDefault();const n=document.getElementById("music-player-float");if(!n)return;const r=e.clientX-a,c=e.clientY-i,l=s+r,d=o+c,u=window.innerWidth-n.offsetWidth,h=window.innerHeight-n.offsetHeight,m=Math.max(0,Math.min(l,u)),f=Math.max(0,Math.min(d,h));n.style.left=m+"px",n.style.top=f+"px",n.style.bottom="auto",n.style.right="auto"}function c(){if(!t)return;t=!1;const n=document.getElementById("music-player-float");n&&(n.classList.remove("dragging"),m(n)),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",c)}function d(e){const t=e.classList.contains("minimized");t?(e.classList.remove("minimized"),localStorage.setItem("musicFloatPlayerMinimized","false")):(e.classList.add("minimized"),localStorage.setItem("musicFloatPlayerMinimized","true"))}function u(e){h(e),e.classList.add("closed"),localStorage.setItem("musicFloatPlayerClosed","true")}function h(e){typeof APlayer!="undefined"&&APlayer.instances&&APlayer.instances.forEach(function(t){e.contains(t.container)&&t.pause()});const t=e.querySelectorAll("audio");t.forEach(function(e){e.pause(),e.currentTime=0});const n=e.querySelectorAll("meting-js");n.forEach(function(e){e.aplayer?e.aplayer.pause():e._aplayer&&e._aplayer.pause();const t=e.querySelector(".aplayer");t&&t.aplayerInstance&&t.aplayerInstance.pause()});const s=e.querySelectorAll(".aplayer");s.forEach(function(e){e.aplayerInstance&&e.aplayerInstance.pause(),typeof APlayer!="undefined"&&APlayer.instances&&APlayer.instances.forEach(function(t){t.container===e&&t.pause()})})}function m(e){const t=e.getBoundingClientRect(),n={left:t.left,top:t.top};localStorage.setItem("musicFloatPlayerPosition",JSON.stringify(n))}function f(e){const t=localStorage.getItem("musicFloatPlayerPosition");if(t)try{const n=JSON.parse(t);e.style.left=n.left+"px",e.style.top=n.top+"px",e.style.bottom="auto",e.style.right="auto"}catch(e){console.warn("Failed to restore music player position:",e)}const n=localStorage.getItem("musicFloatPlayerMinimized")==="true";n&&e.classList.add("minimized")}document.addEventListener("DOMContentLoaded",function(){e()}),document.addEventListener("pjax:complete",function(){setTimeout(e,300)}),typeof window!="undefined"&&window.addEventListener("load",function(){setTimeout(e,500)}),window.initMusicFloatPlayer=e}(),function(){"use strict";class t{constructor(e={}){this.canvas=null,this.ctx=null,this.particles=[],this.animationId=null,this.mouse={x:0,y:0},this.config={enable:e.enable!==!1,particleCount:e.particleCount||80,particleColor:e.particleColor||"rgba(255, 255, 255, 0.5)",lineColor:e.lineColor||"rgba(255, 255, 255, 0.1)",lineDistance:e.lineDistance||150,particleSpeed:e.particleSpeed||.5,particleRadius:e.particleRadius||1.5,interactive:e.interactive!==!1,zIndex:e.zIndex||0},this.config.enable&&this.init()}init(){this.canvas=document.createElement("canvas"),this.canvas.id="particle-canvas",this.canvas.style.position="fixed",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex=this.config.zIndex,this.canvas.style.opacity="1",document.body.insertBefore(this.canvas,document.body.firstChild),this.ctx=this.canvas.getContext("2d"),this.resize(),this.createParticles(),this.bindEvents(),this.animate()}resize(){const e=this.canvas.getBoundingClientRect();this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}createParticles(){this.particles=[];for(let e=0;e<this.config.particleCount;e++)this.particles.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,vx:(Math.random()-.5)*this.config.particleSpeed,vy:(Math.random()-.5)*this.config.particleSpeed,radius:this.config.particleRadius})}bindEvents(){let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{this.resize(),this.createParticles()},100)}),this.config.interactive&&(window.addEventListener("mousemove",e=>{this.mouse.x=e.clientX,this.mouse.y=e.clientY}),window.addEventListener("mouseout",()=>{this.mouse.x=-1e3,this.mouse.y=-1e3})),document.addEventListener("pjax:complete",()=>{this.canvas&&this.canvas.parentNode&&this.resize()})}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=0;t<this.particles.length;t++){const e=this.particles[t];e.x+=e.vx,e.y+=e.vy,(e.x<0||e.x>this.canvas.width)&&(e.vx=-e.vx),(e.y<0||e.y>this.canvas.height)&&(e.vy=-e.vy),e.x=Math.max(0,Math.min(this.canvas.width,e.x)),e.y=Math.max(0,Math.min(this.canvas.height,e.y)),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.radius,0,Math.PI*2),this.ctx.fillStyle=this.config.particleColor,this.ctx.fill();for(let s=t+1;s<this.particles.length;s++){const n=this.particles[s],o=e.x-n.x,i=e.y-n.y,a=(o*o+i*i)**.5;if(a<this.config.lineDistance){const s=(1-a/this.config.lineDistance)*.5;this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(n.x,n.y);let t=this.config.lineColor;t.includes("rgba")&&(t=t.replace(/rgba\(([^)]+)\)/,(e,t)=>{const n=t.split(",");return n.length===4?`rgba(${n[0]}, ${n[1]}, ${n[2]}, ${s.toFixed(2)})`:e})),this.ctx.strokeStyle=t,this.ctx.lineWidth=.5,this.ctx.stroke()}}if(this.config.interactive&&this.mouse.x!==0&&this.mouse.y!==0){const t=e.x-this.mouse.x,n=e.y-this.mouse.y,s=(t*t+n*n)**.5;if(s<this.config.lineDistance*2){const n=(1-s/(this.config.lineDistance*2))*.3;this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(this.mouse.x,this.mouse.y);let t=this.config.lineColor;t.includes("rgba")&&(t=t.replace(/rgba\(([^)]+)\)/,(e,t)=>{const s=t.split(",");return s.length===4?`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${n.toFixed(2)})`:e})),this.ctx.strokeStyle=t,this.ctx.lineWidth=.5,this.ctx.stroke()}}}}animate(){this.draw(),this.animationId=requestAnimationFrame(()=>this.animate())}destroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}function e(){if(!window.siteConfig){console.warn("Particle Effect: siteConfig not found");return}const s=window.siteConfig.particleEffectEnable===!0||window.siteConfig.particleEffectEnable==="true"||String(window.siteConfig.particleEffectEnable).toLowerCase()==="true";if(!s)return;const e={enable:!0,particleCount:parseInt(window.siteConfig.particleEffectCount||"80",10),particleColor:window.siteConfig.particleEffectColor||"rgba(255, 255, 255, 0.5)",lineColor:window.siteConfig.particleEffectLineColor||"rgba(255, 255, 255, 0.1)",lineDistance:parseInt(window.siteConfig.particleEffectLineDistance||"150",10),particleSpeed:parseFloat(window.siteConfig.particleEffectSpeed||"0.5"),particleRadius:parseFloat(window.siteConfig.particleEffectRadius||"1.5"),interactive:window.siteConfig.particleEffectInteractive!==!1,zIndex:parseInt(window.siteConfig.particleEffectZIndex||"0",10)},n=document.documentElement.getAttribute("data-theme")||"light";if(!e.particleColor||e.particleColor.trim()==="")n==="dark"?e.particleColor="rgba(255, 255, 255, 0.5)":e.particleColor="rgba(0, 0, 0, 0.3)";else if(e.particleColor.startsWith("#")){const t=e.particleColor.replace("#",""),n=parseInt(t.substr(0,2),16),s=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16);e.particleColor=`rgba(${n}, ${s}, ${o}, 0.5)`}if(!e.lineColor||e.lineColor.trim()==="")n==="dark"?e.lineColor="rgba(255, 255, 255, 0.1)":e.lineColor="rgba(0, 0, 0, 0.1)";else if(e.lineColor.startsWith("#")){const t=e.lineColor.replace("#",""),n=parseInt(t.substr(0,2),16),s=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16);e.lineColor=`rgba(${n}, ${s}, ${o}, 0.1)`}window.particleEffect=new t(e);const o=new MutationObserver(e=>{e.forEach(e=>{if(e.attributeName==="data-theme"){const e=document.documentElement.getAttribute("data-theme")||"light";if(window.particleEffect){const t=window.siteConfig.particleEffectColor&&window.siteConfig.particleEffectColor.trim()!=="",n=window.siteConfig.particleEffectLineColor&&window.siteConfig.particleEffectLineColor.trim()!=="";t||(e==="dark"?window.particleEffect.config.particleColor="rgba(255, 255, 255, 0.5)":window.particleEffect.config.particleColor="rgba(0, 0, 0, 0.3)"),n||(e==="dark"?window.particleEffect.config.lineColor="rgba(255, 255, 255, 0.1)":window.particleEffect.config.lineColor="rgba(0, 0, 0, 0.1)")}}})});o.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),document.addEventListener("pjax:complete",()=>{window.particleEffect?window.particleEffect.resize():e()})}()})()